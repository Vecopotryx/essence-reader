var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function i(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let o,a;function l(e,t){return o||(o=document.createElement("a")),o.href=t,e===o.href}function c(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(e,t,n,r){if(e){const i=h(e,t,n,r);return e[0](i)}}function h(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function d(e,t,n,r){if(e[2]&&r){const i=e[2](r(n));if(void 0===t.dirty)return i;if("object"==typeof i){const e=[],n=Math.max(t.dirty.length,i.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|i[r];return e}return t.dirty|i}return t.dirty}function f(e,t,n,r,i,s){if(i){const o=h(t,n,r,s);e.p(o,i)}}function p(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function m(e,t){e.appendChild(t)}function g(e,t,n){e.insertBefore(t,n||null)}function y(e){e.parentNode.removeChild(e)}function b(e){return document.createElement(e)}function v(e){return document.createTextNode(e)}function w(){return v(" ")}function x(){return v("")}function _(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function k(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function E(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function $(e,t){e.value=null==t?"":t}function N(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function A(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}e.selectedIndex=-1}class O{constructor(e=!1){this.is_svg=!1,this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){var r;this.e||(this.is_svg?this.e=(r=t.nodeName,document.createElementNS("http://www.w3.org/2000/svg",r)):this.e=b(t.nodeName),this.t=t,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)g(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(y)}}function P(e){a=e}function S(e){(function(){if(!a)throw new Error("Function called outside component initialization");return a})().$$.after_update.push(e)}const C=[],T=[],j=[],B=[],F=Promise.resolve();let I=!1;function D(e){j.push(e)}function K(e){B.push(e)}const R=new Set;let M=0;function L(){const e=a;do{for(;M<C.length;){const e=C[M];M++,P(e),z(e.$$)}for(P(null),C.length=0,M=0;T.length;)T.pop()();for(let e=0;e<j.length;e+=1){const t=j[e];R.has(t)||(R.add(t),t())}j.length=0}while(C.length);for(;B.length;)B.pop()();I=!1,R.clear(),P(e)}function z(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(D)}}const q=new Set;let V;function U(){V={r:0,c:[],p:V}}function W(){V.r||r(V.c),V=V.p}function X(e,t){e&&e.i&&(q.delete(e),e.i(t))}function Y(e,t,n,r){if(e&&e.o){if(q.has(e))return;q.add(e),V.c.push((()=>{q.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}else r&&r()}const H="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function G(e,t){e.d(1),t.delete(e.key)}function Q(e,t,n){const r=e.$$.props[t];void 0!==r&&(e.$$.bound[r]=n,n(e.$$.ctx[r]))}function J(e){e&&e.c()}function Z(e,n,s,o){const{fragment:a,on_mount:l,on_destroy:c,after_update:u}=e.$$;a&&a.m(n,s),o||D((()=>{const n=l.map(t).filter(i);c?c.push(...n):r(n),e.$$.on_mount=[]})),u.forEach(D)}function ee(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function te(e,t){-1===e.$$.dirty[0]&&(C.push(e),I||(I=!0,F.then(L)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ne(t,i,s,o,l,c,u,h=[-1]){const d=a;P(t);const f=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:l,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(i.context||(d?d.$$.context:[])),callbacks:n(),dirty:h,skip_bound:!1,root:i.target||d.$$.root};u&&u(f.root);let p=!1;if(f.ctx=s?s(t,i.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return f.ctx&&l(f.ctx[e],f.ctx[e]=i)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](i),p&&te(t,e)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!o&&o(f.ctx),i.target){if(i.hydrate){const e=function(e){return Array.from(e.childNodes)}(i.target);f.fragment&&f.fragment.l(e),e.forEach(y)}else f.fragment&&f.fragment.c();i.intro&&X(t.$$.fragment),Z(t,i.target,i.anchor,i.customElement),L()}P(d)}class re{$destroy(){ee(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var ie={},se={};!function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n="["+t+"][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*",r=new RegExp("^"+n+"$");e.isExist=function(e){return void 0!==e},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,n){if(t){const r=Object.keys(t),i=r.length;for(let s=0;s<i;s++)e[r[s]]="strict"===n?[t[r[s]]]:t[r[s]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(e){const t=r.exec(e);return!(null==t)},e.getAllMatches=function(e,t){const n=[];let r=t.exec(e);for(;r;){const i=[];i.startIndex=t.lastIndex-r[0].length;const s=r.length;for(let e=0;e<s;e++)i.push(r[e]);n.push(i),r=t.exec(e)}return n},e.nameRegexp=n}(se);const oe=se,ae={allowBooleanAttributes:!1,unpairedTags:[]};function le(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function ce(e,t){const n=t;for(;t<e.length;t++)if("?"!=e[t]&&" "!=e[t]);else{const r=e.substr(n,t-n);if(t>5&&"xml"===r)return me("InvalidXml","XML declaration allowed only at the start of the document.",ye(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}}return t}function ue(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let n=1;for(t+=8;t<e.length;t++)if("<"===e[t])n++;else if(">"===e[t]&&(n--,0===n))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}ie.validate=function(e,t){t=Object.assign({},ae,t);const n=[];let r=!1,i=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let o=0;o<e.length;o++)if("<"===e[o]&&"?"===e[o+1]){if(o+=2,o=ce(e,o),o.err)return o}else{if("<"!==e[o]){if(le(e[o]))continue;return me("InvalidChar","char '"+e[o]+"' is not expected.",ye(e,o))}{let a=o;if(o++,"!"===e[o]){o=ue(e,o);continue}{let l=!1;"/"===e[o]&&(l=!0,o++);let c="";for(;o<e.length&&">"!==e[o]&&" "!==e[o]&&"\t"!==e[o]&&"\n"!==e[o]&&"\r"!==e[o];o++)c+=e[o];if(c=c.trim(),"/"===c[c.length-1]&&(c=c.substring(0,c.length-1),o--),s=c,!oe.isName(s)){let t;return t=0===c.trim().length?"Invalid space after '<'.":"Tag '"+c+"' is an invalid name.",me("InvalidTag",t,ye(e,o))}const u=he(e,o);if(!1===u)return me("InvalidAttr","Attributes for '"+c+"' have open quote.",ye(e,o));let h=u.value;if(o=u.index,"/"===h[h.length-1]){const n=o-h.length;h=h.substring(0,h.length-1);const i=fe(h,t);if(!0!==i)return me(i.err.code,i.err.msg,ye(e,n+i.err.line));r=!0}else if(l){if(!u.tagClosed)return me("InvalidTag","Closing tag '"+c+"' doesn't have proper closing.",ye(e,o));if(h.trim().length>0)return me("InvalidTag","Closing tag '"+c+"' can't have attributes or invalid starting.",ye(e,a));{const t=n.pop();if(c!==t.tagName){let n=ye(e,t.tagStartPos);return me("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+c+"'.",ye(e,a))}0==n.length&&(i=!0)}}else{const s=fe(h,t);if(!0!==s)return me(s.err.code,s.err.msg,ye(e,o-h.length+s.err.line));if(!0===i)return me("InvalidXml","Multiple possible root nodes found.",ye(e,o));-1!==t.unpairedTags.indexOf(c)||n.push({tagName:c,tagStartPos:a}),r=!0}for(o++;o<e.length;o++)if("<"===e[o]){if("!"===e[o+1]){o++,o=ue(e,o);continue}if("?"!==e[o+1])break;if(o=ce(e,++o),o.err)return o}else if("&"===e[o]){const t=pe(e,o);if(-1==t)return me("InvalidChar","char '&' is not expected.",ye(e,o));o=t}else if(!0===i&&!le(e[o]))return me("InvalidXml","Extra text at the end",ye(e,o));"<"===e[o]&&o--}}}var s;return r?1==n.length?me("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",ye(e,n[0].tagStartPos)):!(n.length>0)||me("InvalidXml","Invalid '"+JSON.stringify(n.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):me("InvalidXml","Start tag expected.",1)};function he(e,t){let n="",r="",i=!1;for(;t<e.length;t++){if('"'===e[t]||"'"===e[t])""===r?r=e[t]:r!==e[t]||(r="");else if(">"===e[t]&&""===r){i=!0;break}n+=e[t]}return""===r&&{value:n,index:t,tagClosed:i}}const de=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function fe(e,t){const n=oe.getAllMatches(e,de),r={};for(let e=0;e<n.length;e++){if(0===n[e][1].length)return me("InvalidAttr","Attribute '"+n[e][2]+"' has no space in starting.",be(n[e]));if(void 0!==n[e][3]&&void 0===n[e][4])return me("InvalidAttr","Attribute '"+n[e][2]+"' is without value.",be(n[e]));if(void 0===n[e][3]&&!t.allowBooleanAttributes)return me("InvalidAttr","boolean attribute '"+n[e][2]+"' is not allowed.",be(n[e]));const i=n[e][2];if(!ge(i))return me("InvalidAttr","Attribute '"+i+"' is an invalid name.",be(n[e]));if(r.hasOwnProperty(i))return me("InvalidAttr","Attribute '"+i+"' is repeated.",be(n[e]));r[i]=1}return!0}function pe(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let n=/\d/;for("x"===e[t]&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(n))break}return-1}(e,++t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(";"===e[t])break;return-1}return t}function me(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function ge(e){return oe.isName(e)}function ye(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function be(e){return e.startIndex+e[1].length}var ve={};const we={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1};ve.buildOptions=function(e){return Object.assign({},we,e)},ve.defaultOptions=we;var xe=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){this.child.push({[e]:t})}addChild(e){e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}};const _e=RegExp("^\\s([a-zA-z0-0]+)[ \t](['\"])([^&]+)\\2");function ke(e,t){const n=_e.exec(e);n&&(t[n[1]]={regx:RegExp(`&${n[1]};`,"g"),val:n[3]})}var Ee=function(e,t){const n={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let r=1,i=!1,s=!1,o=!1,a="";for(;t<e.length;t++)if("<"===e[t]){if(i&&"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7])t+=7,s=!0;else if(i&&"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8])t+=8;else{if("!"!==e[t+1]||"-"!==e[t+2]||"-"!==e[t+3])throw new Error("Invalid DOCTYPE");o=!0}r++,a=""}else if(">"===e[t]){if(o){if("-"!==e[t-1]||"-"!==e[t-2])throw new Error("Invalid XML comment in DOCTYPE");o=!1}else s&&(ke(a,n),s=!1);if(r--,0===r)break}else"["===e[t]?i=!0:a+=e[t];if(0!==r)throw new Error("Unclosed DOCTYPE")}return{entities:n,i:t}};const $e=/^[-+]?0x[a-fA-F0-9]+$/,Ne=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const Ae={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};const Oe=se,Pe=xe,Se=Ee,Ce=function(e,t={}){if(t=Object.assign({},Ae,t),!e||"string"!=typeof e)return e;let n=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(n))return e;if(t.hex&&$e.test(n))return Number.parseInt(n,16);{const r=Ne.exec(n);if(r){const i=r[1],s=r[2];let o=function(e){if(e&&-1!==e.indexOf("."))return"."===(e=e.replace(/0+$/,""))?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1)),e;return e}(r[3]);const a=r[4]||r[6];if(!t.leadingZeros&&s.length>0&&i&&"."!==n[2])return e;if(!t.leadingZeros&&s.length>0&&!i&&"."!==n[1])return e;{const r=Number(n),l=""+r;return-1!==l.search(/[eE]/)||a?t.eNotation?r:e:-1!==n.indexOf(".")?"0"===l&&""===o||l===o||i&&l==="-"+o?r:e:s?o===l||i+o===l?r:e:n===l||n===i+l?r:e}}return e}};"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,Oe.nameRegexp);function Te(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const r=t[n];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:e[r]}}}function je(e,t,n,r,i,s,o){if(void 0!==e&&(this.options.trimValues&&!r&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));const r=this.options.tagValueProcessor(t,e,n,i,s);if(null==r)return e;if(typeof r!=typeof e||r!==e)return r;if(this.options.trimValues)return Ve(e,this.options.parseTagValue,this.options.numberParseOptions);return e.trim()===e?Ve(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function Be(e){if(this.options.removeNSPrefix){const t=e.split(":"),n="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=n+t[1])}return e}const Fe=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function Ie(e,t){if(!this.options.ignoreAttributes&&"string"==typeof e){const n=Oe.getAllMatches(e,Fe),r=n.length,i={};for(let e=0;e<r;e++){const r=this.resolveNameSpace(n[e][1]);let s=n[e][4];const o=this.options.attributeNamePrefix+r;if(r.length)if(void 0!==s){this.options.trimValues&&(s=s.trim()),s=this.replaceEntitiesValue(s);const e=this.options.attributeValueProcessor(r,s,t);i[o]=null==e?s:typeof e!=typeof s||e!==s?e:Ve(s,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[o]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=i,e}return i}}const De=function(e){e=e.replace(/\r\n?/g,"\n");const t=new Pe("!xml");let n=t,r="",i="";for(let s=0;s<e.length;s++){if("<"===e[s])if("/"===e[s+1]){const t=Le(e,">",s,"Closing Tag is not closed.");let o=e.substring(s+2,t).trim();if(this.options.removeNSPrefix){const e=o.indexOf(":");-1!==e&&(o=o.substr(e+1))}n&&(r=this.saveTextToParentTag(r,n,i)),i=i.substr(0,i.lastIndexOf(".")),n=this.tagsNodeStack.pop(),r="",s=t}else if("?"===e[s+1]){let t=ze(e,s,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,n,i),this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags);else{const e=new Pe(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,i)),n.addChild(e)}s=t.closeIndex+1}else if("!--"===e.substr(s+1,3)){const t=Le(e,"--\x3e",s+4,"Comment is not closed.");if(this.options.commentPropName){const o=e.substring(s+4,t-2);r=this.saveTextToParentTag(r,n,i),n.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}s=t}else if("!D"===e.substr(s+1,2)){const t=Se(e,s);this.docTypeEntities=t.entities,s=t.i}else if("!["===e.substr(s+1,2)){const t=Le(e,"]]>",s,"CDATA is not closed.")-2,o=e.substring(s+9,t);if(r=this.saveTextToParentTag(r,n,i),this.options.cdataPropName)n.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]);else{let e=this.parseTextData(o,n.tagname,i,!0,!1,!0);null==e&&(e=""),n.add(this.options.textNodeName,e)}s=t+2}else{let o=ze(e,s,this.options.removeNSPrefix),a=o.tagName,l=o.tagExp,c=o.attrExpPresent,u=o.closeIndex;n&&r&&"!xml"!==n.tagname&&(r=this.saveTextToParentTag(r,n,i,!1)),a!==t.tagname&&(i+=i?"."+a:a);const h=n;if(h&&-1!==this.options.unpairedTags.indexOf(h.tagname)&&(n=this.tagsNodeStack.pop()),this.isItStopNode(this.options.stopNodes,i,a)){let t="";if(l.length>0&&l.lastIndexOf("/")===l.length-1)s=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(a))s=o.closeIndex;else{const n=this.readStopNodeData(e,a,u+1);if(!n)throw new Error(`Unexpected end of ${a}`);s=n.i,t=n.tagContent}const r=new Pe(a);a!==l&&c&&(r[":@"]=this.buildAttributesMap(l,i)),t&&(t=this.parseTextData(t,a,i,!0,c,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),r.add(this.options.textNodeName,t),n.addChild(r)}else{if(l.length>0&&l.lastIndexOf("/")===l.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),l=a):l=l.substr(0,l.length-1);const e=new Pe(a);a!==l&&c&&(e[":@"]=this.buildAttributesMap(l,i)),i=i.substr(0,i.lastIndexOf(".")),n.addChild(e)}else{const e=new Pe(a);this.tagsNodeStack.push(n),a!==l&&c&&(e[":@"]=this.buildAttributesMap(l,i)),n.addChild(e),n=e}r="",s=u}}else r+=e[s]}return t.child},Ke=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){const n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}}return e};function Re(e,t,n,r){return e&&(void 0===r&&(r=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,n,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,r))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function Me(e,t,n){const r="*."+n;for(const n in e){const i=e[n];if(r===i||t===i)return!0}return!1}function Le(e,t,n,r){const i=e.indexOf(t,n);if(-1===i)throw new Error(r);return i+t.length-1}function ze(e,t,n,r=">"){const i=function(e,t,n=">"){let r,i="";for(let s=t;s<e.length;s++){let t=e[s];if(r)t===r&&(r="");else if('"'===t||"'"===t)r=t;else if(t===n[0]){if(!n[1])return{data:i,index:s};if(e[s+1]===n[1])return{data:i,index:s}}else"\t"===t&&(t=" ");i+=t}}(e,t+1,r);if(!i)return;let s=i.data;const o=i.index,a=s.search(/\s/);let l=s,c=!0;if(-1!==a&&(l=s.substr(0,a).replace(/\s\s*$/,""),s=s.substr(a+1)),n){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1),c=l!==i.data.substr(e+1))}return{tagName:l,tagExp:s,closeIndex:o,attrExpPresent:c}}function qe(e,t,n){const r=n;let i=1;for(;n<e.length;n++)if("<"===e[n])if("/"===e[n+1]){const s=Le(e,">",n,`${t} is not closed`);if(e.substring(n+2,s).trim()===t&&(i--,0===i))return{tagContent:e.substring(r,n),i:s};n=s}else{const r=ze(e,n,">");if(r){(r&&r.tagName)===t&&i++,n=r.closeIndex}}}function Ve(e,t,n){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&Ce(e,n)}return Oe.isExist(e)?e:""}var Ue=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={amp:{regex:/&(amp|#38|#x26);/g,val:"&"},apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"}},this.addExternalEntities=Te,this.parseXml=De,this.parseTextData=je,this.resolveNameSpace=Be,this.buildAttributesMap=Ie,this.isItStopNode=Me,this.replaceEntitiesValue=Ke,this.readStopNodeData=qe,this.saveTextToParentTag=Re}},We={};function Xe(e,t,n){let r;const i={};for(let s=0;s<e.length;s++){const o=e[s],a=Ye(o);let l="";if(l=void 0===n?a:n+"."+a,a===t.textNodeName)void 0===r?r=o[a]:r+=""+o[a];else{if(void 0===a)continue;if(o[a]){let e=Xe(o[a],t,l);const n=Ge(e,t);o[":@"]?He(e,o[":@"],l,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==i[a]&&i.hasOwnProperty(a)?(Array.isArray(i[a])||(i[a]=[i[a]]),i[a].push(e)):t.isArray(a,l,n)?i[a]=[e]:i[a]=e}}}return"string"==typeof r?r.length>0&&(i[t.textNodeName]=r):void 0!==r&&(i[t.textNodeName]=r),i}function Ye(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(":@"!==n)return n}}function He(e,t,n,r){if(t){const i=Object.keys(t),s=i.length;for(let o=0;o<s;o++){const s=i[o];r.isArray(s,n+"."+s,!0,!0)?e[s]=[t[s]]:e[s]=t[s]}}}function Ge(e,t){const n=Object.keys(e).length;return!!(0===n||1===n&&e[t.textNodeName])}We.prettify=function(e,t){return Xe(e,t)};const{buildOptions:Qe}=ve,Je=Ue,{prettify:Ze}=We,et=ie;var tt=class{constructor(e){this.externalEntities={},this.options=Qe(e)}parse(e,t){if("string"==typeof e);else{if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const n=et.validate(e,t);if(!0!==n)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}const n=new Je(this.options);n.addExternalEntities(this.externalEntities);const r=n.parseXml(e);return this.options.preserveOrder||void 0===r?r:Ze(r,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");this.externalEntities[e]=t}};function nt(e,t,n,r){let i="",s="";t.format&&t.indentBy.length>0&&(s="\n"+t.indentBy.repeat(r));for(let o=0;o<e.length;o++){const a=e[o],l=rt(a);let c="";if(c=0===n.length?l:`${n}.${l}`,l===t.textNodeName){let e=a[l];st(c,t)||(e=t.tagValueProcessor(l,e),e=ot(e,t)),i+=s+e;continue}if(l===t.cdataPropName){i+=s+`<![CDATA[${a[l][0][t.textNodeName]}]]>`;continue}if(l===t.commentPropName){i+=s+`\x3c!--${a[l][0][t.textNodeName]}--\x3e`;continue}if("?"===l[0]){const e=it(a[":@"],t),n="?xml"===l?"":s;let r=a[l][0][t.textNodeName];r=0!==r.length?" "+r:"",i+=n+`<${l}${r}${e}?>`;continue}let u=s+`<${l}${it(a[":@"],t)}`,h=nt(a[l],t,c,r+1);-1!==t.unpairedTags.indexOf(l)?t.suppressUnpairedNode?i+=u+">":i+=u+"/>":h&&0!==h.length||!t.suppressEmptyNode?i+=u+`>${h}${s}</${l}>`:i+=u+"/>"}return i}function rt(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(":@"!==n)return n}}function it(e,t){let n="";if(e&&!t.ignoreAttributes)for(let r in e){let i=t.attributeValueProcessor(r,e[r]);i=ot(i,t),!0===i&&t.suppressBooleanAttributes?n+=` ${r.substr(t.attributeNamePrefix.length)}`:n+=` ${r.substr(t.attributeNamePrefix.length)}="${i}"`}return n}function st(e,t){let n=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let r in t.stopNodes)if(t.stopNodes[r]===e||t.stopNodes[r]==="*."+n)return!0;return!1}function ot(e,t){if(e&&e.length>0&&t.processEntities)for(let n=0;n<t.entities.length;n++){const r=t.entities[n];e=e.replace(r.regex,r.val)}return e}const at=function(e,t){return nt(e,t,"",0)},lt={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[]};function ct(e){this.options=Object.assign({},lt,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=bt),this.processTextOrObjNode=ht,this.options.format?(this.indentate=yt,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine=""),this.options.suppressEmptyNode?(this.buildTextNode=gt,this.buildObjNode=ft):(this.buildTextNode=pt,this.buildObjNode=dt),this.buildTextValNode=pt,this.buildObjectNode=dt,this.replaceEntitiesValue=mt,this.buildAttrPairStr=ut}function ut(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'}function ht(e,t,n){const r=this.j2x(e,n+1);return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextNode(e[this.options.textNodeName],t,r.attrStr,n):this.buildObjNode(r.val,t,r.attrStr,n)}function dt(e,t,n,r){let i="</"+t+this.tagEndChar,s="";return"?"===t[0]&&(s="?",i=""),n&&-1===e.indexOf("<")?this.indentate(r)+"<"+t+n+s+">"+e+i:!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===s.length?this.indentate(r)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(r)+"<"+t+n+s+this.tagEndChar+e+this.indentate(r)+i}function ft(e,t,n,r){return""!==e?this.buildObjectNode(e,t,n,r):"?"===t[0]?this.indentate(r)+"<"+t+n+"?"+this.tagEndChar:this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function pt(e,t,n,r){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(r)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(r)+`\x3c!--${e}--\x3e`+this.newLine;{let i=this.options.tagValueProcessor(t,e);return i=this.replaceEntitiesValue(i),""===i&&-1!==this.options.unpairedTags.indexOf(t)?this.options.suppressUnpairedNode?this.indentate(r)+"<"+t+this.tagEndChar:this.indentate(r)+"<"+t+"/"+this.tagEndChar:this.indentate(r)+"<"+t+n+">"+i+"</"+t+this.tagEndChar}}function mt(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const n=this.options.entities[t];e=e.replace(n.regex,n.val)}return e}function gt(e,t,n,r){return""===e&&-1!==this.options.unpairedTags.indexOf(t)?this.options.suppressUnpairedNode?this.indentate(r)+"<"+t+this.tagEndChar:this.indentate(r)+"<"+t+"/"+this.tagEndChar:""!==e?this.buildTextValNode(e,t,n,r):"?"===t[0]?this.indentate(r)+"<"+t+n+"?"+this.tagEndChar:this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}function yt(e){return this.options.indentBy.repeat(e)}function bt(e){return!!e.startsWith(this.options.attributeNamePrefix)&&e.substr(this.attrPrefixLen)}ct.prototype.build=function(e){return this.options.preserveOrder?at(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)},ct.prototype.j2x=function(e,t){let n="",r="";for(let i in e)if(void 0===e[i]);else if(null===e[i])"?"===i[0]?r+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(t)+"<"+i+"/"+this.tagEndChar;else if(e[i]instanceof Date)r+=this.buildTextNode(e[i],i,"",t);else if("object"!=typeof e[i]){const s=this.isAttribute(i);if(s)n+=this.buildAttrPairStr(s,""+e[i]);else if(i===this.options.textNodeName){let t=this.options.tagValueProcessor(i,""+e[i]);r+=this.replaceEntitiesValue(t)}else r+=this.buildTextNode(e[i],i,"",t)}else if(Array.isArray(e[i])){const n=e[i].length;for(let s=0;s<n;s++){const n=e[i][s];void 0===n||(null===n?"?"===i[0]?r+=this.indentate(t)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(t)+"<"+i+"/"+this.tagEndChar:r+="object"==typeof n?this.processTextOrObjNode(n,i,t):this.buildTextNode(n,i,"",t))}}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const t=Object.keys(e[i]),r=t.length;for(let s=0;s<r;s++)n+=this.buildAttrPairStr(t[s],""+e[i][t[s]])}else r+=this.processTextOrObjNode(e[i],i,t);return{attrStr:n,val:r}};var vt={XMLParser:tt,XMLValidator:ie,XMLBuilder:ct};function wt(e){return e.arrayBuffer?e.arrayBuffer():new Promise(((t,n)=>{const r=new FileReader;r.addEventListener("loadend",(()=>{t(r.result)})),r.addEventListener("error",n),r.readAsArrayBuffer(e)}))}async function xt(e){const t=await wt(e);return new Uint8Array(t)}function _t(e){return"undefined"!=typeof Blob&&e instanceof Blob}function kt(e){return"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer}const Et="undefined"!=typeof process&&process.versions&&void 0!==process.versions.node&&void 0===process.versions.electron;class $t{constructor(e){this.typedArray=e instanceof ArrayBuffer||kt(e)?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}async getLength(){return this.typedArray.byteLength}async read(e,t){return new Uint8Array(this.typedArray.buffer,this.typedArray.byteOffset+e,t)}}class Nt{constructor(e){this.blob=e}async getLength(){return this.blob.size}async read(e,t){const n=this.blob.slice(e,e+t),r=await wt(n);return new Uint8Array(r)}async sliceAsBlob(e,t,n=""){return this.blob.slice(e,e+t,n)}}function At(e,t){var n=e.length;if(t<=n)return e;var r=new Uint8Array(Math.max(n<<1,t));return r.set(e,0),r}function Ot(e,t,n,r,i,s){for(var o=jt,a=Ft,l=0;l<n;){var c=e[a(r,i)&t];i+=15&c;var u=c>>>4;if(u<=15)s[l]=u,l++;else{var h=0,d=0;16==u?(d=3+o(r,i,2),i+=2,h=s[l-1]):17==u?(d=3+o(r,i,3),i+=3):18==u&&(d=11+o(r,i,7),i+=7);for(var f=l+d;l<f;)s[l]=h,l++}}return i}function Pt(e,t,n,r){for(var i=0,s=0,o=r.length>>>1;s<n;){var a=e[s+t];r[s<<1]=0,r[1+(s<<1)]=a,a>i&&(i=a),s++}for(;s<o;)r[s<<1]=0,r[1+(s<<1)]=0,s++;return i}function St(e,t){for(var n,r,i,s,o=e.length,a=It.bl_count,l=0;l<=t;l++)a[l]=0;for(l=1;l<o;l+=2)a[e[l]]++;var c=It.next_code;for(n=0,a[0]=0,r=1;r<=t;r++)n=n+a[r-1]<<1,c[r]=n;for(i=0;i<o;i+=2)0!=(s=e[i+1])&&(e[i]=c[s],c[s]++)}function Ct(e,t,n){for(var r=e.length,i=It.rev15,s=0;s<r;s+=2)if(0!=e[s+1])for(var o=s>>1,a=e[s+1],l=o<<4|a,c=t-a,u=e[s]<<c,h=u+(1<<c);u!=h;){n[i[u]>>>15-t]=l,u++}}function Tt(e,t){for(var n=It.rev15,r=15-t,i=0;i<e.length;i+=2){var s=e[i]<<t-e[i+1];e[i]=n[s]>>>r}}function jt(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8)>>>(7&t)&(1<<n)-1}function Bt(e,t,n){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)&(1<<n)-1}function Ft(e,t){return(e[t>>>3]|e[1+(t>>>3)]<<8|e[2+(t>>>3)]<<16)>>>(7&t)}const It=(Dt=Uint16Array,Kt=Uint32Array,{next_code:new Dt(16),bl_count:new Dt(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new Dt(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new Kt(32),flmap:new Dt(512),fltree:[],fdmap:new Dt(32),fdtree:[],lmap:new Dt(32768),ltree:[],ttree:[],dmap:new Dt(32768),dtree:[],imap:new Dt(512),itree:[],rev15:new Dt(32768),lhst:new Kt(286),dhst:new Kt(30),ihst:new Kt(19),lits:new Kt(15e3),strt:new Dt(65536),prev:new Dt(32768)});var Dt,Kt;!function(){for(var e=0;e<32768;e++){var t=e;t=(4278255360&(t=(4042322160&(t=(3435973836&(t=(2863311530&t)>>>1|(1431655765&t)<<1))>>>2|(858993459&t)<<2))>>>4|(252645135&t)<<4))>>>8|(16711935&t)<<8,It.rev15[e]=(t>>>16|t<<16)>>>17}function n(e,t,n){for(;0!=t--;)e.push(0,n)}for(e=0;e<32;e++)It.ldef[e]=It.of0[e]<<3|It.exb[e],It.ddef[e]=It.df0[e]<<4|It.dxb[e];n(It.fltree,144,8),n(It.fltree,112,9),n(It.fltree,24,7),n(It.fltree,8,8),St(It.fltree,9),Ct(It.fltree,9,It.flmap),Tt(It.fltree,9),n(It.fdtree,32,5),St(It.fdtree,5),Ct(It.fdtree,5,It.fdmap),Tt(It.fdtree,5),n(It.itree,19,0),n(It.ltree,286,0),n(It.dtree,30,0),n(It.ttree,320,0)}();const Rt={table:function(){for(var e=new Uint32Array(256),t=0;t<256;t++){for(var n=t,r=0;r<8;r++)1&n?n=3988292384^n>>>1:n>>>=1;e[t]=n}return e}(),update:function(e,t,n,r){for(var i=0;i<r;i++)e=Rt.table[255&(e^t[n+i])]^e>>>8;return e},crc:function(e,t,n){return 4294967295^Rt.update(4294967295,e,t,n)}};function Mt(e,t){return function(e,t){var n=Uint8Array;if(3==e[0]&&0==e[1])return t||new n(0);var r=Bt,i=jt,s=Ot,o=Ft,a=null==t;a&&(t=new n(e.length>>>2<<3));for(var l,c,u=0,h=0,d=0,f=0,p=0,m=0,g=0,y=0,b=0;0==u;)if(u=r(e,b,1),h=r(e,b+1,2),b+=3,0!=h){if(a&&(t=At(t,y+(1<<17))),1==h&&(l=It.flmap,c=It.fdmap,m=511,g=31),2==h){d=i(e,b,5)+257,f=i(e,b+5,5)+1,p=i(e,b+10,4)+4,b+=14;for(var v=0;v<38;v+=2)It.itree[v]=0,It.itree[v+1]=0;var w=1;for(v=0;v<p;v++){var x=i(e,b+3*v,3);It.itree[1+(It.ordr[v]<<1)]=x,x>w&&(w=x)}b+=3*p,St(It.itree,w),Ct(It.itree,w,It.imap),l=It.lmap,c=It.dmap,b=s(It.imap,(1<<w)-1,d+f,e,b,It.ttree);var _=Pt(It.ttree,0,d,It.ltree);m=(1<<_)-1;var k=Pt(It.ttree,d,f,It.dtree);g=(1<<k)-1,St(It.ltree,_),Ct(It.ltree,_,l),St(It.dtree,k),Ct(It.dtree,k,c)}for(;;){var E=l[o(e,b)&m];b+=15&E;var $=E>>>4;if($>>>8==0)t[y++]=$;else{if(256==$)break;var N=y+$-254;if($>264){var A=It.ldef[$-257];N=y+(A>>>3)+i(e,b,7&A),b+=7&A}var O=c[o(e,b)&g];b+=15&O;var P=O>>>4,S=It.ddef[P],C=(S>>>4)+r(e,b,15&S);for(b+=15&S,a&&(t=At(t,y+(1<<17)));y<N;)t[y]=t[y++-C],t[y]=t[y++-C],t[y]=t[y++-C],t[y]=t[y++-C];y=N}}}else{0!=(7&b)&&(b+=8-(7&b));var T=4+(b>>>3),j=e[T-4]|e[T-3]<<8;a&&(t=At(t,y+j)),t.set(new n(e.buffer,e.byteOffset+T,j),y),b=T+j<<3,y+=j}return t.length==y?t:t.slice(0,y)}(e,t)}const Lt={numWorkers:1,workerURL:"",useWorkers:!1};let zt=0;const qt=[];function Vt(e){return new Promise(((t,n)=>{const r=new Worker(e);r.onmessage=e=>{"start"===e.data?(r.onerror=void 0,r.onmessage=void 0,t(r)):n(new Error(`unexpected message: ${e.data}`))},r.onerror=n}))}function Ut(e,t,n,r){const i=new Uint8Array(t);Mt(e,i),r(n?new Blob([i],{type:n}):i.buffer)}function Wt(e,t,n){return new Promise(((r,i)=>{qt.push({src:e,uncompressedSize:t,type:n,resolve:r,reject:i,id:zt++}),async function(){if(0!==qt.length)for(;qt.length;){const{src:e,uncompressedSize:t,type:n,resolve:r}=qt.shift();let i=e;_t(e)&&(i=await xt(e)),Ut(i,t,n,r)}}()}))}!function(){if(Et){const{Worker:n}=(e=module,t="worker_threads",e.require(t));return{createWorker:async e=>new n(e),addEventListener(e,t){e.on("message",(n=>{t({target:e,data:n})}))},async terminate(e){await e.terminate()}}}return{async createWorker(e){try{return await Vt(e)}catch(t){console.warn("could not load worker:",e)}let t;try{const n=await fetch(e,{mode:"cors"});if(!n.ok)throw new Error(`could not load: ${e}`);t=await n.text(),e=URL.createObjectURL(new Blob([t],{type:"application/javascript"}));const r=await Vt(e);return Lt.workerURL=e,r}catch(t){console.warn("could not load worker via fetch:",e)}if(void 0!==t)try{e=`data:application/javascript;base64,${btoa(t)}`;const n=await Vt(e);return Lt.workerURL=e,n}catch(e){console.warn("could not load worker via dataURI")}throw console.warn("workers will not be used"),new Error("can not start workers")},addEventListener(e,t){e.addEventListener("message",t)},async terminate(e){e.terminate()}};var e,t}();class Xt{constructor(e,t){var n,r;this._reader=e,this._rawEntry=t,this.name=t.name,this.nameBytes=t.nameBytes,this.size=t.uncompressedSize,this.compressedSize=t.compressedSize,this.comment=t.comment,this.commentBytes=t.commentBytes,this.compressionMethod=t.compressionMethod,this.lastModDate=(n=t.lastModFileDate,r=t.lastModFileTime,new Date(1980+(n>>9&127),(n>>5&15)-1,31&n,r>>11&31,r>>5&63,2*(31&r),0)),this.isDirectory=0===t.uncompressedSize&&t.name.endsWith("/"),this.encrypted=!!(1&t.generalPurposeBitFlag),this.externalFileAttributes=t.externalFileAttributes,this.versionMadeBy=t.versionMadeBy}async blob(e="application/octet-stream"){return await async function(e,t,n){const{decompress:r,fileDataStart:i}=await sn(e,t);if(!r){const r=await Ht(e,i,t.compressedSize,n);return _t(r)?r:new Blob([kt(r.buffer)?new Uint8Array(r):r],{type:n})}const s=await Ht(e,i,t.compressedSize);return await Wt(s,t.uncompressedSize,n)}(this._reader,this._rawEntry,e)}async arrayBuffer(){return await async function(e,t){const{decompress:n,fileDataStart:r}=await sn(e,t);if(!n){const n=await Yt(e,r,t.compressedSize);return 0===(i=n).byteOffset&&i.byteLength===i.buffer.byteLength?n.buffer:n.slice().buffer}var i;const s=await Ht(e,r,t.compressedSize);return await Wt(s,t.uncompressedSize)}(this._reader,this._rawEntry)}async text(){const e=await this.arrayBuffer();return tn(new Uint8Array(e))}async json(){const e=await this.text();return JSON.parse(e)}}async function Yt(e,t,n){return await e.read(t,n)}async function Ht(e,t,n,r){return e.sliceAsBlob?await e.sliceAsBlob(t,n,r):await e.read(t,n)}const Gt={unsigned:()=>0};function Qt(e,t){return e[t]+256*e[t+1]}function Jt(e,t){return e[t]+256*e[t+1]+65536*e[t+2]+16777216*e[t+3]}function Zt(e,t){return Jt(e,t)+4294967296*Jt(e,t+4)}const en=new TextDecoder;function tn(e,t){return kt(e.buffer)&&(e=new Uint8Array(e)),en.decode(e)}async function nn(e,t,n,r){const i=t-20,s=await Yt(e,i,20);if(117853008!==Jt(s,0))throw new Error("invalid zip64 end of central directory locator signature");const o=Zt(s,8),a=await Yt(e,o,56);if(101075792!==Jt(a,0))throw new Error("invalid zip64 end of central directory record signature");const l=Zt(a,32),c=Zt(a,40);return rn(e,Zt(a,48),c,l,n,r)}async function rn(e,t,n,r,i,s){let o=0;const a=await Yt(e,t,n),l=[];for(let e=0;e<r;++e){const e=a.subarray(o,o+46),t=Jt(e,0);if(33639248!==t)throw new Error(`invalid central directory file header signature: 0x${t.toString(16)}`);const n={versionMadeBy:Qt(e,4),versionNeededToExtract:Qt(e,6),generalPurposeBitFlag:Qt(e,8),compressionMethod:Qt(e,10),lastModFileTime:Qt(e,12),lastModFileDate:Qt(e,14),crc32:Jt(e,16),compressedSize:Jt(e,20),uncompressedSize:Jt(e,24),fileNameLength:Qt(e,28),extraFieldLength:Qt(e,30),fileCommentLength:Qt(e,32),internalFileAttributes:Qt(e,36),externalFileAttributes:Jt(e,38),relativeOffsetOfLocalHeader:Jt(e,42)};if(64&n.generalPurposeBitFlag)throw new Error("strong encryption is not supported");o+=46;const r=a.subarray(o,o+n.fileNameLength+n.extraFieldLength+n.fileCommentLength);n.nameBytes=r.slice(0,n.fileNameLength),n.name=tn(n.nameBytes);const i=n.fileNameLength+n.extraFieldLength,s=r.slice(n.fileNameLength,i);n.extraFields=[];let c=0;for(;c<s.length-3;){const e=Qt(s,c+0),t=c+4,r=t+Qt(s,c+2);if(r>s.length)throw new Error("extra field length exceeds extra field buffer size");n.extraFields.push({id:e,data:s.slice(t,r)}),c=r}if(n.commentBytes=r.slice(i,i+n.fileCommentLength),n.comment=tn(n.commentBytes),o+=r.length,4294967295===n.uncompressedSize||4294967295===n.compressedSize||4294967295===n.relativeOffsetOfLocalHeader){const e=n.extraFields.find((e=>1===e.id));if(!e)throw new Error("expected zip64 extended information extra field");const t=e.data;let r=0;if(4294967295===n.uncompressedSize){if(r+8>t.length)throw new Error("zip64 extended information extra field does not include uncompressed size");n.uncompressedSize=Zt(t,r),r+=8}if(4294967295===n.compressedSize){if(r+8>t.length)throw new Error("zip64 extended information extra field does not include compressed size");n.compressedSize=Zt(t,r),r+=8}if(4294967295===n.relativeOffsetOfLocalHeader){if(r+8>t.length)throw new Error("zip64 extended information extra field does not include relative header offset");n.relativeOffsetOfLocalHeader=Zt(t,r),r+=8}}const u=n.extraFields.find((e=>28789===e.id&&e.data.length>=6&&1===e.data[0]&&Jt(e.data,1)),Gt.unsigned(n.nameBytes));if(u&&(n.fileName=tn(u.data.slice(5))),0===n.compressionMethod){let e=n.uncompressedSize;if(0!=(1&n.generalPurposeBitFlag)&&(e+=12),n.compressedSize!==e)throw new Error(`compressed size mismatch for stored file: ${n.compressedSize} != ${e}`)}l.push(n)}return{zip:{comment:i,commentBytes:s},entries:l.map((t=>new Xt(e,t)))}}async function sn(e,t){if(1&t.generalPurposeBitFlag)throw new Error("encrypted entries not supported");const n=await Yt(e,t.relativeOffsetOfLocalHeader,30),r=await e.getLength(),i=Jt(n,0);if(67324752!==i)throw new Error(`invalid local file header signature: 0x${i.toString(16)}`);const s=Qt(n,26),o=Qt(n,28),a=t.relativeOffsetOfLocalHeader+n.length+s+o;let l;if(0===t.compressionMethod)l=!1;else{if(8!==t.compressionMethod)throw new Error(`unsupported compression method: ${t.compressionMethod}`);l=!0}const c=a,u=c+t.compressedSize;if(0!==t.compressedSize&&u>r)throw new Error(`file data overflows file bounds: ${c} +  ${t.compressedSize}  > ${r}`);return{decompress:l,fileDataStart:c}}async function on(e){let t;if("undefined"!=typeof Blob&&e instanceof Blob)t=new Nt(e);else if(e instanceof ArrayBuffer||e&&e.buffer&&e.buffer instanceof ArrayBuffer)t=new $t(e);else if(kt(e)||kt(e.buffer))t=new $t(e);else if("string"==typeof e){const n=await fetch(e);if(!n.ok)throw new Error(`failed http request ${e}, status: ${n.status}: ${n.statusText}`);const r=await n.blob();t=new Nt(r)}else{if("function"!=typeof e.getLength||"function"!=typeof e.read)throw new Error("unsupported source type");t=e}const n=await t.getLength();if(n>Number.MAX_SAFE_INTEGER)throw new Error(`file too large. size: ${n}. Only file sizes up 4503599627370496 bytes are supported`);return await async function(e,t){const n=Math.min(65557,t),r=t-n,i=await Yt(e,r,n);for(let t=n-22;t>=0;--t){if(101010256!==Jt(i,t))continue;const n=new Uint8Array(i.buffer,i.byteOffset+t,i.byteLength-t),s=Qt(n,4);if(0!==s)throw new Error(`multi-volume zip files are not supported. This is volume: ${s}`);const o=Qt(n,10),a=Jt(n,12),l=Jt(n,16),c=Qt(n,20),u=n.length-22;if(c!==u)throw new Error(`invalid comment length. expected: ${u}, actual: ${c}`);const h=new Uint8Array(n.buffer,n.byteOffset+22,c),d=tn(h);return 65535===o||4294967295===l?await nn(e,r+t,d,h):await rn(e,l,a,o,d,h)}throw new Error("could not find end of central directory. maybe not zip file")}(t,n)}let an,ln=[],cn=[],un=[],hn=[],dn=[],fn=[];const pn=async e=>(ln=[],un=[],cn=[],hn=[],fn=[],(e=>{const t=new vt.XMLParser({ignoreAttributes:!1}).parse(e).package,n=vn(t.manifest),r=(new vt.XMLParser).parse(e).package;an=bn(void 0===r.metadata?r["opf:metadata"]:r.metadata),wn(t.spine,n)})(await gn(e)),_n(),{meta:an,contents:ln,styles:dn}),mn=e=>{let t=((e,t)=>{let n=[];return(e=(e=e.replace(/@(-moz-|-webkit-|-ms-)*keyframes\s(.*?){([0-9%a-zA-Z,\s.]*{(.*?)})*[\s\n]*}/g,(e=>n.push(e)&&"__keyframes__"))).replace(/([^\r\n,{}]+)(,(?=[^}]*{)|\s*{)/g,(e=>"@"===e.trim()[0]?e:e.replace(/(\s*)/,"$1"+t+" ")))).replace(/__keyframes__/g,(e=>n.shift()))})(e,"#container");return t=t.replace(/url\((?!['"]?(?:data):)['"]?([^'"\)]*)['"]?\)/g,(function(e,t){let n=t.split("\\").pop().split("/").pop(),r=[];[".png",".jpg","jpeg",".gif"].some((e=>n.endsWith(e)))?r=un:[".otf","ttf",".woff"].some((e=>n.endsWith(e)))&&(r=fn);for(let{name:e,url:t}of r)if(e.includes(n))return"url("+t+")";return""})),t},gn=async e=>{const{entries:t}=await async function(e){const{zip:t,entries:n}=await on(e);return{zip:t,entries:Object.fromEntries(n.map((e=>[e.name,e])))}}(e);let n="";for(const[e,r]of Object.entries(t))switch(e.substring(e.lastIndexOf("."))){case".opf":n=await r.text();break;case".png":case".jpg":case".jpeg":case".gif":{const t=await r.blob(),n=URL.createObjectURL(t);un.push({name:e,url:n});break}case".css":{const t=await r.text();dn.push({name:e,css:t});break}case".htm":case".xml":case".html":case".xhtml":{const t=await r.text();hn.push({name:e,html:t});break}case".otf":case".ttf":case".woff":{const t=await r.blob(),n=URL.createObjectURL(t);fn.push({name:e,url:n})}}return n};let yn="";const bn=e=>{const t=e["dc:title"],n=e["dc:creator"];let r=un[0].url;for(let{name:e,url:t}of un){if(e.includes(yn)){r=t;break}e.includes("cover")&&(r=t)}return{title:t,author:n,cover:r}},vn=e=>{let t=[];return e.item.forEach((e=>{"application/xhtml+xml"===e["@_media-type"]||"text/html"===e["@_media-type"]?t.push({id:e["@_id"],href:e["@_href"]}):e["@_media-type"].includes("image")&&e["@_id"].includes("cover")&&(yn=e["@_href"])})),t},wn=(e,t)=>{let n=[];e.itemref.forEach((e=>{n.push(e["@_idref"])})),cn=n.map((e=>t.find((t=>t.id===e))))},xn=e=>{let t=document.createElement("newHTML");t.innerHTML=e.trim();for(let e of t.querySelectorAll("[src],[href]"))switch(e.tagName){case"IMG":{let t=e.getAttribute("src").split("\\").pop().split("/").pop();for(let n=0;n<un.length;n++)if(un[n].name.includes(t)){e.setAttribute("src",un[n].url);break}e.style.cssText+="max-height: 100%; max-width: 100%; object-fit: scale-down;";break}default:null===e.getAttribute("href")||e.getAttribute("href").includes("http")||e.removeAttribute("href"),null===e.getAttribute("src")||e.getAttribute("src").includes("http")||e.removeAttribute("src")}for(let e of t.getElementsByTagName("image")){let t=e.getAttributeNS("http://www.w3.org/1999/xlink","href").split("\\").pop().split("/").pop();for(let n=0;n<un.length;n++)if(un[n].name.includes(t)){e.setAttributeNS("http://www.w3.org/1999/xlink","href",un[n].url);break}}return t.innerHTML},_n=()=>{for(let e=0;e<cn.length;e++)for(const{name:t,html:n}of hn)if(t.includes(cn[e].href)){ln.push(xn(n));break}for(let e=0;e<dn.length;e++)dn[e].css=mn(dn[e].css)},kn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:global,En=Object.keys,$n=Array.isArray;function Nn(e,t){return"object"!=typeof t||En(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||kn.Promise||(kn.Promise=Promise);const An=Object.getPrototypeOf,On={}.hasOwnProperty;function Pn(e,t){return On.call(e,t)}function Sn(e,t){"function"==typeof t&&(t=t(An(e))),("undefined"==typeof Reflect?En:Reflect.ownKeys)(t).forEach((n=>{Tn(e,n,t[n])}))}const Cn=Object.defineProperty;function Tn(e,t,n,r){Cn(e,t,Nn(n&&Pn(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function jn(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Tn(e.prototype,"constructor",e),{extend:Sn.bind(null,e.prototype)}}}}const Bn=Object.getOwnPropertyDescriptor;function Fn(e,t){let n;return Bn(e,t)||(n=An(e))&&Fn(n,t)}const In=[].slice;function Dn(e,t,n){return In.call(e,t,n)}function Kn(e,t){return t(e)}function Rn(e){if(!e)throw new Error("Assertion Failed")}function Mn(e){kn.setImmediate?setImmediate(e):setTimeout(e,0)}function Ln(e,t){return e.reduce(((e,n,r)=>{var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function zn(e,t){if(Pn(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var s=zn(e,t[r]);n.push(s)}return n}var o=t.indexOf(".");if(-1!==o){var a=e[t.substr(0,o)];return void 0===a?void 0:zn(a,t.substr(o+1))}}function qn(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){Rn("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)qn(e,t[r],n[r])}else{var s=t.indexOf(".");if(-1!==s){var o=t.substr(0,s),a=t.substr(s+1);if(""===a)void 0===n?$n(e)&&!isNaN(parseInt(o))?e.splice(o,1):delete e[o]:e[o]=n;else{var l=e[o];l&&Pn(e,o)||(l=e[o]={}),qn(l,a,n)}}else void 0===n?$n(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Vn(e){var t={};for(var n in e)Pn(e,n)&&(t[n]=e[n]);return t}const Un=[].concat;function Wn(e){return Un.apply([],e)}const Xn="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Wn([8,16,32,64].map((e=>["Int","Uint","Float"].map((t=>t+e+"Array")))))).filter((e=>kn[e])),Yn=Xn.map((e=>kn[e]));Ln(Xn,(e=>[e,!0]));let Hn=null;function Gn(e){Hn="undefined"!=typeof WeakMap&&new WeakMap;const t=Qn(e);return Hn=null,t}function Qn(e){if(!e||"object"!=typeof e)return e;let t=Hn&&Hn.get(e);if(t)return t;if($n(e)){t=[],Hn&&Hn.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Qn(e[n]))}else if(Yn.indexOf(e.constructor)>=0)t=e;else{const n=An(e);for(var i in t=n===Object.prototype?{}:Object.create(n),Hn&&Hn.set(e,t),e)Pn(e,i)&&(t[i]=Qn(e[i]))}return t}const{toString:Jn}={};function Zn(e){return Jn.call(e).slice(8,-1)}const er="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",tr="symbol"==typeof er?function(e){var t;return null!=e&&(t=e[er])&&t.apply(e)}:function(){return null},nr={};function rr(e){var t,n,r,i;if(1===arguments.length){if($n(e))return e.slice();if(this===nr&&"string"==typeof e)return[e];if(i=tr(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}const ir="undefined"!=typeof Symbol?e=>"AsyncFunction"===e[Symbol.toStringTag]:()=>!1;var sr="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function or(e,t){sr=e,ar=t}var ar=()=>!0;const lr=!new Error("").stack;function cr(){if(lr)try{throw cr.arguments,new Error}catch(e){return e}return new Error}function ur(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(ar).map((e=>"\n"+e)).join("")):""}var hr=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],dr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(hr),fr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function pr(e,t){this._e=cr(),this.name=e,this.message=t}function mr(e,t){return e+". Errors: "+Object.keys(t).map((e=>t[e].toString())).filter(((e,t,n)=>n.indexOf(e)===t)).join("\n")}function gr(e,t,n,r){this._e=cr(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=mr(e,t)}function yr(e,t){this._e=cr(),this.name="BulkError",this.failures=Object.keys(t).map((e=>t[e])),this.failuresByPos=t,this.message=mr(e,t)}jn(pr).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+ur(this._e,2))}},toString:function(){return this.name+": "+this.message}}),jn(gr).from(pr),jn(yr).from(pr);var br=dr.reduce(((e,t)=>(e[t]=t+"Error",e)),{});const vr=pr;var wr=dr.reduce(((e,t)=>{var n=t+"Error";function r(e,r){this._e=cr(),this.name=n,e?"string"==typeof e?(this.message=`${e}${r?"\n "+r:""}`,this.inner=r||null):"object"==typeof e&&(this.message=`${e.name} ${e.message}`,this.inner=e):(this.message=fr[t]||n,this.inner=null)}return jn(r).from(vr),e[t]=r,e}),{});wr.Syntax=SyntaxError,wr.Type=TypeError,wr.Range=RangeError;var xr=hr.reduce(((e,t)=>(e[t+"Error"]=wr[t],e)),{});var _r=dr.reduce(((e,t)=>(-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=wr[t]),e)),{});function kr(){}function Er(e){return e}function $r(e,t){return null==e||e===Er?t:function(n){return t(e(n))}}function Nr(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ar(e,t){return e===kr?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var s=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Nr(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Nr(i,this.onerror):i),void 0!==s?s:n}}function Or(e,t){return e===kr?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Nr(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Nr(r,this.onerror):r)}}function Pr(e,t){return e===kr?t:function(n){var r=e.apply(this,arguments);Nn(n,r);var i=this.onsuccess,s=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Nr(i,this.onsuccess):i),s&&(this.onerror=this.onerror?Nr(s,this.onerror):s),void 0===r?void 0===o?void 0:o:Nn(r,o)}}function Sr(e,t){return e===kr?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Cr(e,t){return e===kr?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,s=new Array(i);i--;)s[i]=arguments[i];return n.then((function(){return t.apply(r,s)}))}return t.apply(this,arguments)}}_r.ModifyError=gr,_r.DexieError=pr,_r.BulkError=yr;var Tr={};const[jr,Br,Fr]="undefined"==typeof Promise?[]:(()=>{let e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,An(e),e];const t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,An(t),e]})(),Ir=Br&&Br.then,Dr=jr&&jr.constructor,Kr=!!Fr;var Rr=!1,Mr=Fr?()=>{Fr.then(ci)}:kn.setImmediate?setImmediate.bind(null,ci):kn.MutationObserver?()=>{var e=document.createElement("div");new MutationObserver((()=>{ci(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:()=>{setTimeout(ci,0)},Lr=function(e,t){Gr.push([e,t]),qr&&(Mr(),qr=!1)},zr=!0,qr=!0,Vr=[],Ur=[],Wr=null,Xr=Er,Yr={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Bi,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((e=>{try{Bi(e[0],e[1])}catch(e){}}))}},Hr=Yr,Gr=[],Qr=0,Jr=[];function Zr(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=kr,this._lib=!1;var t=this._PSD=Hr;if(sr&&(this._stackHolder=cr(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==Tr)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&ri(this,this._value))}this._state=null,this._value=null,++t.ref,ni(this,e)}const ei={get:function(){var e=Hr,t=vi;function n(n,r){var i=!e.global&&(e!==Hr||t!==vi);const s=i&&!ki();var o=new Zr(((t,o)=>{si(this,new ti(Ci(n,e,i,s),Ci(r,e,i,s),t,o,e))}));return sr&&li(o,this),o}return n.prototype=Tr,n},set:function(e){Tn(this,"then",e&&e.prototype===Tr?ei:{get:function(){return e},set:ei.set})}};function ti(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function ni(e,t){try{t((t=>{if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&ui();t&&"function"==typeof t.then?ni(e,((e,n)=>{t instanceof Zr?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,ii(e)),n&&hi()}}),ri.bind(null,e))}catch(t){ri(e,t)}}function ri(e,t){if(Ur.push(t),null===e._state){var n=e._lib&&ui();t=Xr(t),e._state=!1,e._value=t,sr&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((()=>{var n=Fn(t,"stack");t._promise=e,Tn(t,"stack",{get:()=>Rr?n&&(n.get?n.get.apply(t):n.value):e.stack})})),function(e){Vr.some((t=>t._value===e._value))||Vr.push(e)}(e),ii(e),n&&hi()}}function ii(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)si(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===Qr&&(++Qr,Lr((()=>{0==--Qr&&di()}),[]))}function si(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++Qr,Lr(oi,[n,e,t])}else e._listeners.push(t)}function oi(e,t,n){try{Wr=t;var r,i=t._value;t._state?r=e(i):(Ur.length&&(Ur=[]),r=e(i),-1===Ur.indexOf(i)&&function(e){var t=Vr.length;for(;t;)if(Vr[--t]._value===e._value)return void Vr.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{Wr=null,0==--Qr&&di(),--n.psd.ref||n.psd.finalize()}}function ai(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,s,o=e._value;null!=o?(i=o.name||"Error",s=o.message||o,r=ur(o,0)):(i=o,s=""),t.push(i+(s?": "+s:"")+r)}return sr&&((r=ur(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&ai(e._prev,t,n)),t}function li(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function ci(){ui()&&hi()}function ui(){var e=zr;return zr=!1,qr=!1,e}function hi(){var e,t,n;do{for(;Gr.length>0;)for(e=Gr,Gr=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(Gr.length>0);zr=!0,qr=!0}function di(){var e=Vr;Vr=[],e.forEach((e=>{e._PSD.onunhandled.call(null,e._value,e)}));for(var t=Jr.slice(0),n=t.length;n;)t[--n]()}function fi(e){return new Zr(Tr,!1,e)}function pi(e,t){var n=Hr;return function(){var r=ui(),i=Hr;try{return Ai(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Ai(i,!1),r&&hi()}}}Sn(Zr.prototype,{then:ei,_then:function(e,t){si(this,new ti(null,null,e,t,Hr))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(e=>e instanceof t?n(e):fi(e))):this.then(null,(e=>e&&e.name===t?n(e):fi(e)))},finally:function(e){return this.then((t=>(e(),t)),(t=>(e(),fi(t))))},stack:{get:function(){if(this._stack)return this._stack;try{Rr=!0;var e=ai(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{Rr=!1}}},timeout:function(e,t){return e<1/0?new Zr(((n,r)=>{var i=setTimeout((()=>r(new wr.Timeout(t))),e);this.then(n,r).finally(clearTimeout.bind(null,i))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Tn(Zr.prototype,Symbol.toStringTag,"Dexie.Promise"),Yr.env=Oi(),Sn(Zr,{all:function(){var e=rr.apply(null,arguments).map(Ei);return new Zr((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach(((i,s)=>Zr.resolve(i).then((n=>{e[s]=n,--r||t(e)}),n)))}))},resolve:e=>{if(e instanceof Zr)return e;if(e&&"function"==typeof e.then)return new Zr(((t,n)=>{e.then(t,n)}));var t=new Zr(Tr,!0,e);return li(t,Wr),t},reject:fi,race:function(){var e=rr.apply(null,arguments).map(Ei);return new Zr(((t,n)=>{e.map((e=>Zr.resolve(e).then(t,n)))}))},PSD:{get:()=>Hr,set:e=>Hr=e},totalEchoes:{get:()=>vi},newPSD:xi,usePSD:Pi,scheduler:{get:()=>Lr,set:e=>{Lr=e}},rejectionMapper:{get:()=>Xr,set:e=>{Xr=e}},follow:(e,t)=>new Zr(((n,r)=>xi(((t,n)=>{var r=Hr;r.unhandleds=[],r.onunhandled=n,r.finalize=Nr((function(){!function(e){function t(){e(),Jr.splice(Jr.indexOf(t),1)}Jr.push(t),++Qr,Lr((()=>{0==--Qr&&di()}),[])}((()=>{0===this.unhandleds.length?t():n(this.unhandleds[0])}))}),r.finalize),e()}),t,n,r)))}),Dr&&(Dr.allSettled&&Tn(Zr,"allSettled",(function(){const e=rr.apply(null,arguments).map(Ei);return new Zr((t=>{0===e.length&&t([]);let n=e.length;const r=new Array(n);e.forEach(((e,i)=>Zr.resolve(e).then((e=>r[i]={status:"fulfilled",value:e}),(e=>r[i]={status:"rejected",reason:e})).then((()=>--n||t(r)))))}))})),Dr.any&&"undefined"!=typeof AggregateError&&Tn(Zr,"any",(function(){const e=rr.apply(null,arguments).map(Ei);return new Zr(((t,n)=>{0===e.length&&n(new AggregateError([]));let r=e.length;const i=new Array(r);e.forEach(((e,s)=>Zr.resolve(e).then((e=>t(e)),(e=>{i[s]=e,--r||n(new AggregateError(i))}))))}))})));const mi={awaits:0,echoes:0,id:0};var gi=0,yi=[],bi=0,vi=0,wi=0;function xi(e,t,n,r){var i=Hr,s=Object.create(i);s.parent=i,s.ref=0,s.global=!1,s.id=++wi;var o=Yr.env;s.env=Kr?{Promise:Zr,PromiseProp:{value:Zr,configurable:!0,writable:!0},all:Zr.all,race:Zr.race,allSettled:Zr.allSettled,any:Zr.any,resolve:Zr.resolve,reject:Zr.reject,nthen:Ti(o.nthen,s),gthen:Ti(o.gthen,s)}:{},t&&Nn(s,t),++i.ref,s.finalize=function(){--this.parent.ref||this.parent.finalize()};var a=Pi(s,e,n,r);return 0===s.ref&&s.finalize(),a}function _i(){return mi.id||(mi.id=++gi),++mi.awaits,mi.echoes+=100,mi.id}function ki(){return!!mi.awaits&&(0==--mi.awaits&&(mi.id=0),mi.echoes=100*mi.awaits,!0)}function Ei(e){return mi.echoes&&e&&e.constructor===Dr?(_i(),e.then((e=>(ki(),e)),(e=>(ki(),Fi(e))))):e}function $i(e){++vi,mi.echoes&&0!=--mi.echoes||(mi.echoes=mi.id=0),yi.push(Hr),Ai(e,!0)}function Ni(){var e=yi[yi.length-1];yi.pop(),Ai(e,!1)}function Ai(e,t){var n=Hr;if((t?!mi.echoes||bi++&&e===Hr:!bi||--bi&&e===Hr)||Si(t?$i.bind(null,e):Ni),e!==Hr&&(Hr=e,n===Yr&&(Yr.env=Oi()),Kr)){var r=Yr.env.Promise,i=e.env;Br.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(kn,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Oi(){var e=kn.Promise;return Kr?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(kn,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Br.then,gthen:e.prototype.then}:{}}function Pi(e,t,n,r,i){var s=Hr;try{return Ai(e,!0),t(n,r,i)}finally{Ai(s,!1)}}function Si(e){Ir.call(jr,e)}function Ci(e,t,n,r){return"function"!=typeof e?e:function(){var i=Hr;n&&_i(),Ai(t,!0);try{return e.apply(this,arguments)}finally{Ai(i,!1),r&&Si(ki)}}}function Ti(e,t){return function(n,r){return e.call(this,Ci(n,t),Ci(r,t))}}-1===(""+Ir).indexOf("[native code]")&&(_i=ki=kr);const ji="unhandledrejection";function Bi(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(kn.document&&document.createEvent?((r=document.createEvent("Event")).initEvent(ji,!0,!0),Nn(r,i)):kn.CustomEvent&&Nn(r=new CustomEvent(ji,{detail:i}),i),r&&kn.dispatchEvent&&(dispatchEvent(r),!kn.PromiseRejectionEvent&&kn.onunhandledrejection))try{kn.onunhandledrejection(r)}catch(e){}sr&&r&&!r.defaultPrevented&&console.warn(`Unhandled rejection: ${e.stack||e}`)}catch(e){}}var Fi=Zr.reject;function Ii(e,t,n,r){if(e.idbdb&&(e._state.openComplete||Hr.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===br.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>Ii(e,t,n,r)))):Fi(i)}return i._promise(t,((e,t)=>xi((()=>(Hr.trans=i,r(e,t,i)))))).then((e=>i._completion.then((()=>e))))}if(e._state.openComplete)return Fi(new wr.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Fi(new wr.DatabaseClosed);e.open().catch(kr)}return e._state.dbReadyPromise.then((()=>Ii(e,t,n,r)))}const Di="3.2.2",Ki=String.fromCharCode(65535),Ri=-1/0,Mi="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Li="String expected.",zi=[],qi="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),Vi=qi,Ui=qi,Wi=e=>!/(dexie\.js|dexie\.min\.js)/.test(e),Xi="__dbnames",Yi="readonly",Hi="readwrite";function Gi(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}const Qi={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Ji(e){return"string"!=typeof e||/\./.test(e)?e=>e:t=>(void 0===t[e]&&e in t&&delete(t=Gn(t))[e],t)}class Zi{_trans(e,t,n){const r=this._tx||Hr.trans,i=this.name;function s(e,n,r){if(!r.schema[i])throw new wr.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}const o=ui();try{return r&&r.db===this.db?r===Hr.trans?r._promise(e,s,n):xi((()=>r._promise(e,s,n)),{trans:r,transless:Hr.transless||Hr}):Ii(this.db,e,[this.name],s)}finally{o&&hi()}}get(e,t){return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(t=>this.core.get({trans:t,key:e}).then((e=>this.hook.reading.fire(e))))).then(t)}where(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if($n(e))return new this.db.WhereClause(this,`[${e.join("+")}]`);const t=En(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);const n=this.schema.indexes.concat(this.schema.primKey).filter((e=>e.compound&&t.every((t=>e.keyPath.indexOf(t)>=0))&&e.keyPath.every((e=>t.indexOf(e)>=0))))[0];if(n&&this.db._maxKey!==Ki)return this.where(n.name).equals(n.keyPath.map((t=>e[t])));!n&&sr&&console.warn(`The query ${JSON.stringify(e)} on ${this.name} would benefit of a compound index [${t.join("+")}]`);const{idxByName:r}=this.schema,i=this.db._deps.indexedDB;function s(e,t){try{return 0===i.cmp(e,t)}catch(e){return!1}}const[o,a]=t.reduce((([t,n],i)=>{const o=r[i],a=e[i];return[t||o,t||!o?Gi(n,o&&o.multi?e=>{const t=zn(e,i);return $n(t)&&t.some((e=>s(a,e)))}:e=>s(a,zn(e,i))):n]}),[null,null]);return o?this.where(o.name).equals(e[o.keyPath]).filter(a):n?this.filter(a):this.where(t).equals("")}filter(e){return this.toCollection().and(e)}count(e){return this.toCollection().count(e)}offset(e){return this.toCollection().offset(e)}limit(e){return this.toCollection().limit(e)}each(e){return this.toCollection().each(e)}toArray(e){return this.toCollection().toArray(e)}toCollection(){return new this.db.Collection(new this.db.WhereClause(this))}orderBy(e){return new this.db.Collection(new this.db.WhereClause(this,$n(e)?`[${e.join("+")}]`:e))}reverse(){return this.toCollection().reverse()}mapToClass(e){this.schema.mappedClass=e;const t=t=>{if(!t)return t;const n=Object.create(e.prototype);for(var r in t)if(Pn(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e}defineClass(){return this.mapToClass((function(e){Nn(this,e)}))}add(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=Ji(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[i]}))).then((e=>e.numFailures?Zr.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{qn(e,r,t)}catch(e){}return t}))}update(e,t){if("object"!=typeof e||$n(e))return this.where(":id").equals(e).modify(t);{const n=zn(e,this.schema.primKey.keyPath);if(void 0===n)return Fi(new wr.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?En(t).forEach((n=>{qn(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)}}put(e,t){const{auto:n,keyPath:r}=this.schema.primKey;let i=e;return r&&n&&(i=Ji(r)(e)),this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"put",values:[i],keys:null!=t?[t]:null}))).then((e=>e.numFailures?Zr.reject(e.failures[0]):e.lastResult)).then((t=>{if(r)try{qn(e,r,t)}catch(e){}return t}))}delete(e){return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:[e]}))).then((e=>e.numFailures?Zr.reject(e.failures[0]):void 0))}clear(){return this._trans("readwrite",(e=>this.core.mutate({trans:e,type:"deleteRange",range:Qi}))).then((e=>e.numFailures?Zr.reject(e.failures[0]):void 0))}bulkGet(e){return this._trans("readonly",(t=>this.core.getMany({keys:e,trans:t}).then((e=>e.map((e=>this.hook.reading.fire(e)))))))}bulkAdd(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:s}=this.schema.primKey;if(s&&r)throw new wr.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new wr.InvalidArgument("Arguments objects and keys must have the same length");const o=e.length;let a=s&&n?e.map(Ji(s)):e;return this.core.mutate({trans:t,type:"add",keys:r,values:a,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new yr(`${this.name}.bulkAdd(): ${e} of ${o} operations failed`,r)}))}))}bulkPut(e,t,n){const r=Array.isArray(t)?t:void 0,i=(n=n||(r?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(t=>{const{auto:n,keyPath:s}=this.schema.primKey;if(s&&r)throw new wr.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(r&&r.length!==e.length)throw new wr.InvalidArgument("Arguments objects and keys must have the same length");const o=e.length;let a=s&&n?e.map(Ji(s)):e;return this.core.mutate({trans:t,type:"put",keys:r,values:a,wantResults:i}).then((({numFailures:e,results:t,lastResult:n,failures:r})=>{if(0===e)return i?t:n;throw new yr(`${this.name}.bulkPut(): ${e} of ${o} operations failed`,r)}))}))}bulkDelete(e){const t=e.length;return this._trans("readwrite",(t=>this.core.mutate({trans:t,type:"delete",keys:e}))).then((({numFailures:e,lastResult:n,failures:r})=>{if(0===e)return n;throw new yr(`${this.name}.bulkDelete(): ${e} of ${t} operations failed`,r)}))}}function es(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,s=new Array(i-1);--i;)s[i-1]=arguments[i];return t[n].subscribe.apply(null,s),e}if("string"==typeof n)return t[n]};n.addEventType=s;for(var r=1,i=arguments.length;r<i;++r)s(arguments[r]);return n;function s(e,r,i){if("object"==typeof e)return o(e);r||(r=Sr),i||(i=kr);var s={subscribers:[],fire:i,subscribe:function(e){-1===s.subscribers.indexOf(e)&&(s.subscribers.push(e),s.fire=r(s.fire,e))},unsubscribe:function(e){s.subscribers=s.subscribers.filter((function(t){return t!==e})),s.fire=s.subscribers.reduce(r,i)}};return t[e]=n[e]=s,s}function o(e){En(e).forEach((function(t){var n=e[t];if($n(n))s(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new wr.InvalidArgument("Invalid event config");var r=s(t,Er,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){Mn((function(){e.apply(null,t)}))}))}))}}))}}function ts(e,t){return jn(t).from({prototype:e}),t}function ns(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function rs(e,t){e.filter=Gi(e.filter,t)}function is(e,t,n){var r=e.replayFilter;e.replayFilter=r?()=>Gi(r(),t()):t,e.justLimit=n&&!r}function ss(e,t){if(e.isPrimKey)return t.primaryKey;const n=t.getIndexByKeyPath(e.index);if(!n)throw new wr.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function os(e,t,n){const r=ss(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function as(e,t,n,r){const i=e.replayFilter?Gi(e.filter,e.replayFilter()):e.filter;if(e.or){const s={},o=(e,n,r)=>{if(!i||i(n,r,(e=>n.stop(e)),(e=>n.fail(e)))){var o=n.primaryKey,a=""+o;"[object ArrayBuffer]"===a&&(a=""+new Uint8Array(o)),Pn(s,a)||(s[a]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(o,n),ls(os(e,r,n),e.algorithm,o,!e.keysOnly&&e.valueMapper)])}return ls(os(e,r,n),Gi(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function ls(e,t,n,r){var i=pi(r?(e,t,i)=>n(r(e),t,i):n);return e.then((e=>{if(e)return e.start((()=>{var n=()=>e.continue();t&&!t(e,(e=>n=e),(t=>{e.stop(t),n=kr}),(t=>{e.fail(t),n=kr}))||i(e.value,e,(e=>n=e)),n()}))}))}function cs(e,t){try{const n=us(e),r=us(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return n===r?0:n<r?-1:1}(hs(e),hs(t));case"Array":return function(e,t){const n=e.length,r=t.length,i=n<r?n:r;for(let n=0;n<i;++n){const r=cs(e[n],t[n]);if(0!==r)return r}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function us(e){const t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";const n=Zn(e);return"ArrayBuffer"===n?"binary":n}function hs(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}class ds{_read(e,t){var n=this._ctx;return n.error?n.table._trans(null,Fi.bind(null,n.error)):n.table._trans("readonly",e).then(t)}_write(e){var t=this._ctx;return t.error?t.table._trans(null,Fi.bind(null,t.error)):t.table._trans("readwrite",e,"locked")}_addAlgorithm(e){var t=this._ctx;t.algorithm=Gi(t.algorithm,e)}_iterate(e,t){return as(this._ctx,e,t,this._ctx.table.core)}clone(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&Nn(n,e),t._ctx=n,t}raw(){return this._ctx.valueMapper=null,this}each(e){var t=this._ctx;return this._read((n=>as(t,e,n,t.table.core)))}count(e){return this._read((e=>{const t=this._ctx,n=t.table.core;if(ns(t,!0))return n.count({trans:e,query:{index:ss(t,n.schema),range:t.range}}).then((e=>Math.min(e,t.limit)));var r=0;return as(t,(()=>(++r,!1)),e,n).then((()=>r))})).then(e)}sortBy(e,t){const n=e.split(".").reverse(),r=n[0],i=n.length-1;function s(e,t){return t?s(e[n[t]],t-1):e[r]}var o="next"===this._ctx.dir?1:-1;function a(e,t){var n=s(e,i),r=s(t,i);return n<r?-o:n>r?o:0}return this.toArray((function(e){return e.sort(a)})).then(t)}toArray(e){return this._read((e=>{var t=this._ctx;if("next"===t.dir&&ns(t,!0)&&t.limit>0){const{valueMapper:n}=t,r=ss(t,t.table.core.schema);return t.table.core.query({trans:e,limit:t.limit,values:!0,query:{index:r,range:t.range}}).then((({result:e})=>n?e.map(n):e))}{const n=[];return as(t,(e=>n.push(e)),e,t.table.core).then((()=>n))}}),e)}offset(e){var t=this._ctx;return e<=0||(t.offset+=e,ns(t)?is(t,(()=>{var t=e;return(e,n)=>0===t||(1===t?(--t,!1):(n((()=>{e.advance(t),t=0})),!1))})):is(t,(()=>{var t=e;return()=>--t<0}))),this}limit(e){return this._ctx.limit=Math.min(this._ctx.limit,e),is(this._ctx,(()=>{var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this}until(e,t){return rs(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this}first(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)}last(e){return this.reverse().first(e)}filter(e){var t,n;return rs(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=Gi(t.isMatch,n),this}and(e){return this.filter(e)}or(e){return new this.db.WhereClause(this._ctx.table,e,this)}reverse(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this}desc(){return this.reverse()}eachKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))}eachUniqueKey(e){return this._ctx.unique="unique",this.eachKey(e)}eachPrimaryKey(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))}keys(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)}primaryKeys(e){var t=this._ctx;if("next"===t.dir&&ns(t,!0)&&t.limit>0)return this._read((e=>{var n=ss(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((({result:e})=>e)).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)}uniqueKeys(e){return this._ctx.unique="unique",this.keys(e)}firstKey(e){return this.limit(1).keys((function(e){return e[0]})).then(e)}lastKey(e){return this.reverse().firstKey(e)}distinct(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return rs(this._ctx,(function(e){var t=e.primaryKey.toString(),r=Pn(n,t);return n[t]=!0,!r})),this}modify(e){var t=this._ctx;return this._write((n=>{var r;if("function"==typeof e)r=e;else{var i=En(e),s=i.length;r=function(t){for(var n=!1,r=0;r<s;++r){var o=i[r],a=e[o];zn(t,o)!==a&&(qn(t,o,a),n=!0)}return n}}const o=t.table.core,{outbound:a,extractKey:l}=o.schema.primaryKey,c=this.db._options.modifyChunkSize||200,u=[];let h=0;const d=[],f=(e,t)=>{const{failures:n,numFailures:r}=t;h+=e-r;for(let e of En(n))u.push(n[e])};return this.clone().primaryKeys().then((i=>{const s=u=>{const h=Math.min(c,i.length-u);return o.getMany({trans:n,keys:i.slice(u,u+h),cache:"immutable"}).then((d=>{const p=[],m=[],g=a?[]:null,y=[];for(let e=0;e<h;++e){const t=d[e],n={value:Gn(t),primKey:i[u+e]};!1!==r.call(n,n.value,n)&&(null==n.value?y.push(i[u+e]):a||0===cs(l(t),l(n.value))?(m.push(n.value),a&&g.push(i[u+e])):(y.push(i[u+e]),p.push(n.value)))}const b=ns(t)&&t.limit===1/0&&("function"!=typeof e||e===fs)&&{index:t.index,range:t.range};return Promise.resolve(p.length>0&&o.mutate({trans:n,type:"add",values:p}).then((e=>{for(let t in e.failures)y.splice(parseInt(t),1);f(p.length,e)}))).then((()=>(m.length>0||b&&"object"==typeof e)&&o.mutate({trans:n,type:"put",keys:g,values:m,criteria:b,changeSpec:"function"!=typeof e&&e}).then((e=>f(m.length,e))))).then((()=>(y.length>0||b&&e===fs)&&o.mutate({trans:n,type:"delete",keys:y,criteria:b}).then((e=>f(y.length,e))))).then((()=>i.length>u+h&&s(u+c)))}))};return s(0).then((()=>{if(u.length>0)throw new gr("Error modifying one or more objects",u,h,d);return i.length}))}))}))}delete(){var e=this._ctx,t=e.range;return ns(e)&&(e.isPrimKey&&!Ui||3===t.type)?this._write((n=>{const{primaryKey:r}=e.table.core.schema,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((t=>e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((({failures:e,lastResult:n,results:r,numFailures:i})=>{if(i)throw new gr("Could not delete some values",Object.keys(e).map((t=>e[t])),t-i);return t-i}))))})):this.modify(fs)}}const fs=(e,t)=>t.value=null;function ps(e,t){return e<t?-1:e===t?0:1}function ms(e,t){return e>t?-1:e===t?0:1}function gs(e,t,n){var r=e instanceof _s?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function ys(e){return new e.Collection(e,(()=>xs(""))).limit(0)}function bs(e,t,n,r,i,s){for(var o=Math.min(e.length,r.length),a=-1,l=0;l<o;++l){var c=t[l];if(c!==r[l])return i(e[l],n[l])<0?e.substr(0,l)+n[l]+n.substr(l+1):i(e[l],r[l])<0?e.substr(0,l)+r[l]+n.substr(l+1):a>=0?e.substr(0,a)+t[a]+n.substr(a+1):null;i(e[l],c)<0&&(a=l)}return o<r.length&&"next"===s?e+n.substr(e.length):o<e.length&&"prev"===s?e.substr(0,n.length):a<0?null:e.substr(0,a)+r[a]+n.substr(a+1)}function vs(e,t,n,r){var i,s,o,a,l,c,u,h=n.length;if(!n.every((e=>"string"==typeof e)))return gs(e,Li);function d(e){i=function(e){return"next"===e?e=>e.toUpperCase():e=>e.toLowerCase()}(e),s=function(e){return"next"===e?e=>e.toLowerCase():e=>e.toUpperCase()}(e),o="next"===e?ps:ms;var t=n.map((function(e){return{lower:s(e),upper:i(e)}})).sort((function(e,t){return o(e.lower,t.lower)}));a=t.map((function(e){return e.upper})),l=t.map((function(e){return e.lower})),c=e,u="next"===e?"":r}d("next");var f=new e.Collection(e,(()=>ws(a[0],l[h-1]+r)));f._ondirectionchange=function(e){d(e)};var p=0;return f._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var d=s(i);if(t(d,l,p))return!0;for(var f=null,m=p;m<h;++m){var g=bs(i,d,a[m],l[m],o,c);null===g&&null===f?p=m+1:(null===f||o(f,g)>0)&&(f=g)}return n(null!==f?function(){e.continue(f+u)}:r),!1})),f}function ws(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function xs(e){return{type:1,lower:e,upper:e}}class _s{get Collection(){return this._ctx.table.db.Collection}between(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?ys(this):new this.Collection(this,(()=>ws(e,t,!n,!r)))}catch(e){return gs(this,Mi)}}equals(e){return null==e?gs(this,Mi):new this.Collection(this,(()=>xs(e)))}above(e){return null==e?gs(this,Mi):new this.Collection(this,(()=>ws(e,void 0,!0)))}aboveOrEqual(e){return null==e?gs(this,Mi):new this.Collection(this,(()=>ws(e,void 0,!1)))}below(e){return null==e?gs(this,Mi):new this.Collection(this,(()=>ws(void 0,e,!1,!0)))}belowOrEqual(e){return null==e?gs(this,Mi):new this.Collection(this,(()=>ws(void 0,e)))}startsWith(e){return"string"!=typeof e?gs(this,Li):this.between(e,e+Ki,!0,!0)}startsWithIgnoreCase(e){return""===e?this.startsWith(e):vs(this,((e,t)=>0===e.indexOf(t[0])),[e],Ki)}equalsIgnoreCase(e){return vs(this,((e,t)=>e===t[0]),[e],"")}anyOfIgnoreCase(){var e=rr.apply(nr,arguments);return 0===e.length?ys(this):vs(this,((e,t)=>-1!==t.indexOf(e)),e,"")}startsWithAnyOfIgnoreCase(){var e=rr.apply(nr,arguments);return 0===e.length?ys(this):vs(this,((e,t)=>t.some((t=>0===e.indexOf(t)))),e,Ki)}anyOf(){const e=rr.apply(nr,arguments);let t=this._cmp;try{e.sort(t)}catch(e){return gs(this,Mi)}if(0===e.length)return ys(this);const n=new this.Collection(this,(()=>ws(e[0],e[e.length-1])));n._ondirectionchange=n=>{t="next"===n?this._ascending:this._descending,e.sort(t)};let r=0;return n._addAlgorithm(((n,i,s)=>{const o=n.key;for(;t(o,e[r])>0;)if(++r,r===e.length)return i(s),!1;return 0===t(o,e[r])||(i((()=>{n.continue(e[r])})),!1)})),n}notEqual(e){return this.inAnyRange([[Ri,e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})}noneOf(){const e=rr.apply(nr,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return gs(this,Mi)}const t=e.reduce(((e,t)=>e?e.concat([[e[e.length-1][1],t]]):[[Ri,t]]),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})}inAnyRange(e,t){const n=this._cmp,r=this._ascending,i=this._descending,s=this._min,o=this._max;if(0===e.length)return ys(this);if(!e.every((e=>void 0!==e[0]&&void 0!==e[1]&&r(e[0],e[1])<=0)))return gs(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",wr.InvalidArgument);const a=!t||!1!==t.includeLowers,l=t&&!0===t.includeUppers;let c,u=r;function h(e,t){return u(e[0],t[0])}try{c=e.reduce((function(e,t){let r=0,i=e.length;for(;r<i;++r){const i=e[r];if(n(t[0],i[1])<0&&n(t[1],i[0])>0){i[0]=s(i[0],t[0]),i[1]=o(i[1],t[1]);break}}return r===i&&e.push(t),e}),[]),c.sort(h)}catch(e){return gs(this,Mi)}let d=0;const f=l?e=>r(e,c[d][1])>0:e=>r(e,c[d][1])>=0,p=a?e=>i(e,c[d][0])>0:e=>i(e,c[d][0])>=0;let m=f;const g=new this.Collection(this,(()=>ws(c[0][0],c[c.length-1][1],!a,!l)));return g._ondirectionchange=e=>{"next"===e?(m=f,u=r):(m=p,u=i),c.sort(h)},g._addAlgorithm(((e,t,n)=>{for(var i=e.key;m(i);)if(++d,d===c.length)return t(n),!1;return!!function(e){return!f(e)&&!p(e)}(i)||(0===this._cmp(i,c[d][1])||0===this._cmp(i,c[d][0])||t((()=>{u===r?e.continue(c[d][0]):e.continue(c[d][1])})),!1)})),g}startsWithAnyOf(){const e=rr.apply(nr,arguments);return e.every((e=>"string"==typeof e))?0===e.length?ys(this):this.inAnyRange(e.map((e=>[e,e+Ki]))):gs(this,"startsWithAnyOf() only works with strings")}}function ks(e){return pi((function(t){return Es(t),e(t.target.error),!1}))}function Es(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}const $s="storagemutated",Ns="x-storagemutated-1",As=es(null,$s);class Os{_lock(){return Rn(!Hr.global),++this._reculock,1!==this._reculock||Hr.global||(Hr.lockOwnerFor=this),this}_unlock(){if(Rn(!Hr.global),0==--this._reculock)for(Hr.global||(Hr.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Pi(e[1],e[0])}catch(e){}}return this}_locked(){return this._reculock&&Hr.lockOwnerFor!==this}create(e){if(!this.mode)return this;const t=this.db.idbdb,n=this.db._state.dbOpenError;if(Rn(!this.idbtrans),!e&&!t)switch(n&&n.name){case"DatabaseClosedError":throw new wr.DatabaseClosed(n);case"MissingAPIError":throw new wr.MissingAPI(n.message,n);default:throw new wr.OpenFailed(n)}if(!this.active)throw new wr.TransactionInactive;return Rn(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):t.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=pi((t=>{Es(t),this._reject(e.error)})),e.onabort=pi((t=>{Es(t),this.active&&this._reject(new wr.Abort(e.error)),this.active=!1,this.on("abort").fire(t)})),e.oncomplete=pi((()=>{this.active=!1,this._resolve(),"mutatedParts"in e&&As.storagemutated.fire(e.mutatedParts)})),this}_promise(e,t,n){if("readwrite"===e&&"readwrite"!==this.mode)return Fi(new wr.ReadOnly("Transaction is readonly"));if(!this.active)return Fi(new wr.TransactionInactive);if(this._locked())return new Zr(((r,i)=>{this._blockedFuncs.push([()=>{this._promise(e,t,n).then(r,i)},Hr])}));if(n)return xi((()=>{var e=new Zr(((e,n)=>{this._lock();const r=t(e,n,this);r&&r.then&&r.then(e,n)}));return e.finally((()=>this._unlock())),e._lib=!0,e}));var r=new Zr(((e,n)=>{var r=t(e,n,this);r&&r.then&&r.then(e,n)}));return r._lib=!0,r}_root(){return this.parent?this.parent._root():this}waitFor(e){var t=this._root();const n=Zr.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((()=>n));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new Zr(((e,r)=>{n.then((n=>t._waitingQueue.push(pi(e.bind(null,n)))),(e=>t._waitingQueue.push(pi(r.bind(null,e))))).finally((()=>{t._waitingFor===i&&(t._waitingFor=null)}))}))}abort(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new wr.Abort))}table(e){const t=this._memoizedTables||(this._memoizedTables={});if(Pn(t,e))return t[e];const n=this.schema[e];if(!n)throw new wr.NotFound("Table "+e+" not part of transaction");const r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r}}function Ps(e,t,n,r,i,s,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:s,src:(n&&!o?"&":"")+(r?"*":"")+(i?"++":"")+Ss(t)}}function Ss(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Cs(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Ln(n,(e=>[e.name,e]))}}let Ts=e=>{try{return e.only([[]]),Ts=()=>[[]],[[]]}catch(e){return Ts=()=>Ki,Ki}};function js(e){return null==e?()=>{}:"string"==typeof e?function(e){return 1===e.split(".").length?t=>t[e]:t=>zn(t,e)}(e):t=>zn(t,e)}function Bs(e){return[].slice.call(e)}let Fs=0;function Is(e){return null==e?":id":"string"==typeof e?e:`[${e.join("+")}]`}function Ds(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");const{lower:n,upper:r,lowerOpen:i,upperOpen:s}=e;return void 0===n?void 0===r?null:t.upperBound(r,!!s):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!s)}const{schema:i,hasGetAll:s}=function(e,t){const n=Bs(e.objectStoreNames);return{schema:{name:e.name,tables:n.map((e=>t.objectStore(e))).map((e=>{const{keyPath:t,autoIncrement:n}=e,r=$n(t),i=null==t,s={},o={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:js(t)},indexes:Bs(e.indexNames).map((t=>e.index(t))).map((e=>{const{name:t,unique:n,multiEntry:r,keyPath:i}=e,o={name:t,compound:$n(i),keyPath:i,unique:n,multiEntry:r,extractKey:js(i)};return s[Is(i)]=o,o})),getIndexByKeyPath:e=>s[Is(e)]};return s[":id"]=o.primaryKey,null!=t&&(s[Is(t)]=o.primaryKey),o}))},hasGetAll:n.length>0&&"getAll"in t.objectStore(n[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}(e,n),o=i.tables.map((e=>function(e){const t=e.name;return{name:t,schema:e,mutate:function({trans:e,type:n,keys:i,values:s,range:o}){return new Promise(((a,l)=>{a=pi(a);const c=e.objectStore(t),u=null==c.keyPath,h="put"===n||"add"===n;if(!h&&"delete"!==n&&"deleteRange"!==n)throw new Error("Invalid operation type: "+n);const{length:d}=i||s||{length:1};if(i&&s&&i.length!==s.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return a({numFailures:0,failures:{},results:[],lastResult:void 0});let f;const p=[],m=[];let g=0;const y=e=>{++g,Es(e)};if("deleteRange"===n){if(4===o.type)return a({numFailures:g,failures:m,results:[],lastResult:void 0});3===o.type?p.push(f=c.clear()):p.push(f=c.delete(r(o)))}else{const[e,t]=h?u?[s,i]:[s,null]:[i,null];if(h)for(let r=0;r<d;++r)p.push(f=t&&void 0!==t[r]?c[n](e[r],t[r]):c[n](e[r])),f.onerror=y;else for(let t=0;t<d;++t)p.push(f=c[n](e[t])),f.onerror=y}const b=e=>{const t=e.target.result;p.forEach(((e,t)=>null!=e.error&&(m[t]=e.error))),a({numFailures:g,failures:m,results:"delete"===n?i:p.map((e=>e.result)),lastResult:t})};f.onerror=e=>{y(e),b(e)},f.onsuccess=b}))},getMany:({trans:e,keys:n})=>new Promise(((r,i)=>{r=pi(r);const s=e.objectStore(t),o=n.length,a=new Array(o);let l,c=0,u=0;const h=e=>{const t=e.target;a[t._pos]=t.result,++u===c&&r(a)},d=ks(i);for(let e=0;e<o;++e)null!=n[e]&&(l=s.get(n[e]),l._pos=e,l.onsuccess=h,l.onerror=d,++c);0===c&&r(a)})),get:({trans:e,key:n})=>new Promise(((r,i)=>{r=pi(r);const s=e.objectStore(t).get(n);s.onsuccess=e=>r(e.target.result),s.onerror=ks(i)})),query:function(e){return n=>new Promise(((i,s)=>{i=pi(i);const{trans:o,values:a,limit:l,query:c}=n,u=l===1/0?void 0:l,{index:h,range:d}=c,f=o.objectStore(t),p=h.isPrimaryKey?f:f.index(h.name),m=r(d);if(0===l)return i({result:[]});if(e){const e=a?p.getAll(m,u):p.getAllKeys(m,u);e.onsuccess=e=>i({result:e.target.result}),e.onerror=ks(s)}else{let e=0;const t=a||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),n=[];t.onsuccess=r=>{const s=t.result;return s?(n.push(a?s.value:s.primaryKey),++e===l?i({result:n}):void s.continue()):i({result:n})},t.onerror=ks(s)}}))}(s),openCursor:function({trans:e,values:n,query:i,reverse:s,unique:o}){return new Promise(((a,l)=>{a=pi(a);const{index:c,range:u}=i,h=e.objectStore(t),d=c.isPrimaryKey?h:h.index(c.name),f=s?o?"prevunique":"prev":o?"nextunique":"next",p=n||!("openKeyCursor"in d)?d.openCursor(r(u),f):d.openKeyCursor(r(u),f);p.onerror=ks(l),p.onsuccess=pi((t=>{const n=p.result;if(!n)return void a(null);n.___id=++Fs,n.done=!1;const r=n.continue.bind(n);let i=n.continuePrimaryKey;i&&(i=i.bind(n));const s=n.advance.bind(n),o=()=>{throw new Error("Cursor not stopped")};n.trans=e,n.stop=n.continue=n.continuePrimaryKey=n.advance=()=>{throw new Error("Cursor not started")},n.fail=pi(l),n.next=function(){let e=1;return this.start((()=>e--?this.continue():this.stop())).then((()=>this))},n.start=e=>{const t=new Promise(((e,t)=>{e=pi(e),p.onerror=ks(t),n.fail=t,n.stop=t=>{n.stop=n.continue=n.continuePrimaryKey=n.advance=o,e(t)}})),a=()=>{if(p.result)try{e()}catch(e){n.fail(e)}else n.done=!0,n.start=()=>{throw new Error("Cursor behind last entry")},n.stop()};return p.onsuccess=pi((e=>{p.onsuccess=a,a()})),n.continue=r,n.continuePrimaryKey=i,n.advance=s,a(),t},a(n)}),l)}))},count({query:e,trans:n}){const{index:i,range:s}=e;return new Promise(((e,o)=>{const a=n.objectStore(t),l=i.isPrimaryKey?a:a.index(i.name),c=r(s),u=c?l.count(c):l.count();u.onsuccess=pi((t=>e(t.target.result))),u.onerror=ks(o)}))}}}(e))),a={};return o.forEach((e=>a[e.name]=e)),{stack:"dbcore",transaction:e.transaction.bind(e),table(e){if(!a[e])throw new Error(`Table '${e}' not found`);return a[e]},MIN_KEY:-1/0,MAX_KEY:Ts(t),schema:i}}function Ks({_novip:e},t){const n=t.db,r=function(e,t,{IDBKeyRange:n,indexedDB:r},i){const s=function(e,t){return t.reduce(((e,{create:t})=>({...e,...t(e)})),e)}(Ds(t,n,i),e.dbcore);return{dbcore:s}}(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach((t=>{const n=t.name;e.core.schema.tables.some((e=>e.name===n))&&(t.core=e.core.table(n),e[n]instanceof e.Table&&(e[n].core=t.core))}))}function Rs({_novip:e},t,n,r){n.forEach((n=>{const i=r[n];t.forEach((t=>{const r=Fn(t,n);(!r||"value"in r&&void 0===r.value)&&(t===e.Transaction.prototype||t instanceof e.Transaction?Tn(t,n,{get(){return this.table(n)},set(e){Cn(this,n,{value:e,writable:!0,configurable:!0,enumerable:!0})}}):t[n]=new e.Table(n,i))}))}))}function Ms({_novip:e},t){t.forEach((t=>{for(let n in t)t[n]instanceof e.Table&&delete t[n]}))}function Ls(e,t){return e._cfg.version-t._cfg.version}function zs(e,t,n,r){const i=e._dbSchema,s=e._createTransaction("readwrite",e._storeNames,i);s.create(n),s._completion.catch(r);const o=s._reject.bind(s),a=Hr.transless||Hr;xi((()=>{Hr.trans=s,Hr.transless=a,0===t?(En(i).forEach((e=>{Vs(n,e,i[e].primKey,i[e].indexes)})),Ks(e,n),Zr.follow((()=>e.on.populate.fire(s))).catch(o)):function({_novip:e},t,n,r){const i=[],s=e._versions;let o=e._dbSchema=Ws(e,e.idbdb,r),a=!1;function l(){return i.length?Zr.resolve(i.shift()(n.idbtrans)).then(l):Zr.resolve()}return s.filter((e=>e._cfg.version>=t)).forEach((s=>{i.push((()=>{const i=o,l=s._cfg.dbschema;Xs(e,i,r),Xs(e,l,r),o=e._dbSchema=l;const c=qs(i,l);c.add.forEach((e=>{Vs(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((e=>{if(e.recreate)throw new wr.Upgrade("Not yet support for changing primary key");{const t=r.objectStore(e.name);e.add.forEach((e=>Us(t,e))),e.change.forEach((e=>{t.deleteIndex(e.name),Us(t,e)})),e.del.forEach((e=>t.deleteIndex(e)))}}));const u=s._cfg.contentUpgrade;if(u&&s._cfg.version>t){Ks(e,r),n._memoizedTables={},a=!0;let t=Vn(l);c.del.forEach((e=>{t[e]=i[e]})),Ms(e,[e.Transaction.prototype]),Rs(e,[e.Transaction.prototype],En(t),t),n.schema=t;const s=ir(u);let o;s&&_i();const h=Zr.follow((()=>{if(o=u(n),o&&s){var e=ki.bind(null,null);o.then(e,e)}}));return o&&"function"==typeof o.then?Zr.resolve(o):h.then((()=>o))}})),i.push((t=>{if(!a||!Vi){!function(e,t){[].slice.call(t.db.objectStoreNames).forEach((n=>null==e[n]&&t.db.deleteObjectStore(n)))}(s._cfg.dbschema,t)}Ms(e,[e.Transaction.prototype]),Rs(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}))})),l().then((()=>{var e,t;t=r,En(e=o).forEach((n=>{t.db.objectStoreNames.contains(n)||Vs(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,s,n).catch(o)}))}function qs(e,t){const n={del:[],add:[],change:[]};let r;for(r in e)t[r]||n.del.push(r);for(r in t){const i=e[r],s=t[r];if(i){const e={name:r,def:s,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(s.primKey.keyPath||"")||i.primKey.auto!==s.primKey.auto&&!qi)e.recreate=!0,n.change.push(e);else{const t=i.idxByName,r=s.idxByName;let o;for(o in t)r[o]||e.del.push(o);for(o in r){const n=t[o],i=r[o];n?n.src!==i.src&&e.change.push(i):e.add.push(i)}(e.del.length>0||e.add.length>0||e.change.length>0)&&n.change.push(e)}}else n.add.push([r,s])}return n}function Vs(e,t,n,r){const i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((e=>Us(i,e))),i}function Us(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function Ws(e,t,n){const r={};return Dn(t.objectStoreNames,0).forEach((e=>{const t=n.objectStore(e);let i=t.keyPath;const s=Ps(Ss(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),o=[];for(let e=0;e<t.indexNames.length;++e){const n=t.index(t.indexNames[e]);i=n.keyPath;var a=Ps(n.name,i,!!n.unique,!!n.multiEntry,!1,i&&"string"!=typeof i,!1);o.push(a)}r[e]=Cs(e,s,o)})),r}function Xs({_novip:e},t,n){const r=n.db.objectStoreNames;for(let i=0;i<r.length;++i){const s=r[i],o=n.objectStore(s);e._hasGetAll="getAll"in o;for(let e=0;e<o.indexNames.length;++e){const n=o.indexNames[e],r=o.index(n).keyPath,i="string"==typeof r?r:"["+Dn(r).join("+")+"]";if(t[s]){const e=t[s].idxByName[i];e&&(e.name=n,delete t[s].idxByName[i],t[s].idxByName[n]=e)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&kn.WorkerGlobalScope&&kn instanceof kn.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}class Ys{_parseStoresSpec(e,t){En(e).forEach((n=>{if(null!==e[n]){var r=e[n].split(",").map(((e,t)=>{const n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Ps(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),$n(r),0===t)})),i=r.shift();if(i.multi)throw new wr.Schema("Primary key cannot be multi-valued");r.forEach((e=>{if(e.auto)throw new wr.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new wr.Schema("Index must have a name and cannot be an empty string")})),t[n]=Cs(n,i,r)}}))}stores(e){const t=this.db;this._cfg.storesSource=this._cfg.storesSource?Nn(this._cfg.storesSource,e):e;const n=t._versions,r={};let i={};return n.forEach((e=>{Nn(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,Ms(t,[t._allTables,t,t.Transaction.prototype]),Rs(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],En(i),i),t._storeNames=En(i),this}upgrade(e){return this._cfg.contentUpgrade=Cr(this._cfg.contentUpgrade||kr,e),this}}function Hs(e,t){let n=e._dbNamesDB;return n||(n=e._dbNamesDB=new bo(Xi,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function Gs(e){return e&&"function"==typeof e.databases}function Qs(e){return xi((function(){return Hr.letThrough=!0,e()}))}function Js(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function Zs(e){const t=e._state,{indexedDB:n}=e._deps;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((()=>t.dbOpenError?Fi(t.dbOpenError):e));sr&&(t.openCanceller._stackHolder=cr()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;const r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new wr.DatabaseClosed("db.open() was cancelled")}let s=t.dbReadyResolve,o=null,a=!1;return Zr.race([r,("undefined"==typeof navigator?Zr.resolve():Js()).then((()=>new Zr(((r,s)=>{if(i(),!n)throw new wr.MissingAPI;const l=e.name,c=t.autoSchema?n.open(l):n.open(l,Math.round(10*e.verno));if(!c)throw new wr.MissingAPI;c.onerror=ks(s),c.onblocked=pi(e._fireOnBlocked),c.onupgradeneeded=pi((r=>{if(o=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Es,o.abort(),c.result.close();const e=n.deleteDatabase(l);e.onsuccess=e.onerror=pi((()=>{s(new wr.NoSuchDatabase(`Database ${l} doesnt exist`))}))}else{o.onerror=ks(s);var i=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;a=i<1,e._novip.idbdb=c.result,zs(e,i/10,o,s)}}),s),c.onsuccess=pi((()=>{o=null;const n=e._novip.idbdb=c.result,i=Dn(n.objectStoreNames);if(i.length>0)try{const r=n.transaction(1===(s=i).length?s[0]:s,"readonly");t.autoSchema?function({_novip:e},t,n){e.verno=t.version/10;const r=e._dbSchema=Ws(0,t,n);e._storeNames=Dn(t.objectStoreNames,0),Rs(e,[e._allTables],En(r),r)}(e,n,r):(Xs(e,e._dbSchema,r),function(e,t){const n=qs(Ws(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((e=>e.add.length||e.change.length)))}(e,r)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Ks(e,r)}catch(e){}var s;zi.push(e),n.onversionchange=pi((n=>{t.vcFired=!0,e.on("versionchange").fire(n)})),n.onclose=pi((t=>{e.on("close").fire(t)})),a&&function({indexedDB:e,IDBKeyRange:t},n){!Gs(e)&&n!==Xi&&Hs(e,t).put({name:n}).catch(kr)}(e._deps,l),r()}),s)}))))]).then((()=>(i(),t.onReadyBeingFired=[],Zr.resolve(Qs((()=>e.on.ready.fire(e.vip)))).then((function n(){if(t.onReadyBeingFired.length>0){let r=t.onReadyBeingFired.reduce(Cr,kr);return t.onReadyBeingFired=[],Zr.resolve(Qs((()=>r(e.vip)))).then(n)}}))))).finally((()=>{t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((()=>e)).catch((n=>{t.dbOpenError=n;try{o&&o.abort()}catch(e){}return r===t.openCanceller&&e._close(),Fi(n)})).finally((()=>{t.openComplete=!0,s()}))}function eo(e){var t=t=>e.next(t),n=i(t),r=i((t=>e.throw(t)));function i(e){return t=>{var i=e(t),s=i.value;return i.done?s:s&&"function"==typeof s.then?s.then(n,r):$n(s)?Promise.all(s).then(n,r):n(s)}}return i(t)()}function to(e,t,n){var r=arguments.length;if(r<2)throw new wr.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var s=Wn(i);return[e,s,n]}function no(e,t,n,r,i){return Zr.resolve().then((()=>{const s=Hr.transless||Hr,o=e._createTransaction(t,n,e._dbSchema,r),a={trans:o,transless:s};if(r)o.idbtrans=r.idbtrans;else try{o.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===br.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((()=>no(e,t,n,null,i)))):Fi(r)}const l=ir(i);let c;l&&_i();const u=Zr.follow((()=>{if(c=i.call(o,o),c)if(l){var e=ki.bind(null,null);c.then(e,e)}else"function"==typeof c.next&&"function"==typeof c.throw&&(c=eo(c))}),a);return(c&&"function"==typeof c.then?Zr.resolve(c).then((e=>o.active?e:Fi(new wr.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn")))):u.then((()=>c))).then((e=>(r&&o._resolve(),o._completion.then((()=>e))))).catch((e=>(o._reject(e),Fi(e))))}))}function ro(e,t,n){const r=$n(e)?e.slice():[e];for(let e=0;e<n;++e)r.push(t);return r}const io={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return{...e,table(t){const n=e.table(t),{schema:r}=n,i={},s=[];function o(e,t,n){const r=Is(e),a=i[r]=i[r]||[],l=null==e?0:"string"==typeof e?1:e.length,c=t>0,u={...n,isVirtual:c,keyTail:t,keyLength:l,extractKey:js(e),unique:!c&&n.unique};if(a.push(u),u.isPrimaryKey||s.push(u),l>1){o(2===l?e[0]:e.slice(0,l-1),t+1,n)}return a.sort(((e,t)=>e.keyTail-t.keyTail)),u}const a=o(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[a];for(const e of r.indexes)o(e.keyPath,0,e);function l(t){const n=t.query.index;return n.isVirtual?{...t,query:{index:n,range:(r=t.query.range,i=n.keyTail,{type:1===r.type?2:r.type,lower:ro(r.lower,r.lowerOpen?e.MAX_KEY:e.MIN_KEY,i),lowerOpen:!0,upper:ro(r.upper,r.upperOpen?e.MIN_KEY:e.MAX_KEY,i),upperOpen:!0})}}:t;var r,i}const c={...n,schema:{...r,primaryKey:a,indexes:s,getIndexByKeyPath:function(e){const t=i[Is(e)];return t&&t[0]}},count:e=>n.count(l(e)),query:e=>n.query(l(e)),openCursor(t){const{keyTail:r,isVirtual:i,keyLength:s}=t.query.index;if(!i)return n.openCursor(t);return n.openCursor(l(t)).then((n=>n&&function(n){const i=Object.create(n,{continue:{value:function(i){null!=i?n.continue(ro(i,t.reverse?e.MAX_KEY:e.MIN_KEY,r)):t.unique?n.continue(n.key.slice(0,s).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,r)):n.continue()}},continuePrimaryKey:{value(t,i){n.continuePrimaryKey(ro(t,e.MAX_KEY,r),i)}},primaryKey:{get:()=>n.primaryKey},key:{get(){const e=n.key;return 1===s?e[0]:e.slice(0,s)}},value:{get:()=>n.value}});return i}(n)))}};return c}}}};function so(e,t,n,r){return n=n||{},r=r||"",En(e).forEach((i=>{if(Pn(t,i)){var s=e[i],o=t[i];if("object"==typeof s&&"object"==typeof o&&s&&o){const e=Zn(s);e!==Zn(o)?n[r+i]=t[i]:"Object"===e?so(s,o,n,r+i+"."):s!==o&&(n[r+i]=t[i])}else s!==o&&(n[r+i]=t[i])}else n[r+i]=void 0})),En(t).forEach((i=>{Pn(e,i)||(n[r+i]=t[i])})),n}const oo={stack:"dbcore",name:"HooksMiddleware",level:2,create:e=>({...e,table(t){const n=e.table(t),{primaryKey:r}=n.schema,i={...n,mutate(e){const i=Hr.trans,{deleting:s,creating:o,updating:a}=i.table(t).hook;switch(e.type){case"add":if(o.fire===kr)break;return i._promise("readwrite",(()=>l(e)),!0);case"put":if(o.fire===kr&&a.fire===kr)break;return i._promise("readwrite",(()=>l(e)),!0);case"delete":if(s.fire===kr)break;return i._promise("readwrite",(()=>l(e)),!0);case"deleteRange":if(s.fire===kr)break;return i._promise("readwrite",(()=>function(e){return c(e.trans,e.range,1e4)}(e)),!0)}return n.mutate(e);function l(e){const t=Hr.trans,i=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?{...e,keys:i}:{...e}).type&&(e.values=[...e.values]),e.keys&&(e.keys=[...e.keys]),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,i).then((l=>{const c=i.map(((n,i)=>{const c=l[i],u={onerror:null,onsuccess:null};if("delete"===e.type)s.fire.call(u,n,c,t);else if("add"===e.type||void 0===c){const s=o.fire.call(u,n,e.values[i],t);null==n&&null!=s&&(n=s,e.keys[i]=n,r.outbound||qn(e.values[i],r.keyPath,n))}else{const r=so(c,e.values[i]),s=a.fire.call(u,r,n,c,t);if(s){const t=e.values[i];Object.keys(s).forEach((e=>{Pn(t,e)?t[e]=s[e]:qn(t,e,s[e])}))}}return u}));return n.mutate(e).then((({failures:t,results:n,numFailures:r,lastResult:s})=>{for(let r=0;r<i.length;++r){const s=n?n[r]:i[r],o=c[r];null==s?o.onerror&&o.onerror(t[r]):o.onsuccess&&o.onsuccess("put"===e.type&&l[r]?e.values[r]:s)}return{failures:t,results:n,numFailures:r,lastResult:s}})).catch((e=>(c.forEach((t=>t.onerror&&t.onerror(e))),Promise.reject(e))))}))}function c(e,t,i){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:i}).then((({result:n})=>l({type:"delete",keys:n,trans:e}).then((r=>r.numFailures>0?Promise.reject(r.failures[0]):n.length<i?{failures:[],numFailures:0,lastResult:void 0}:c(e,{...t,lower:n[n.length-1],lowerOpen:!0},i)))))}}};return i}})};function ao(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;const r=[];for(let i=0,s=0;i<t.keys.length&&s<e.length;++i)0===cs(t.keys[i],e[s])&&(r.push(n?Gn(t.values[i]):t.values[i]),++s);return r.length===e.length?r:null}catch(e){return null}}const lo={stack:"dbcore",level:-1,create:e=>({table:t=>{const n=e.table(t);return{...n,getMany:e=>{if(!e.cache)return n.getMany(e);const t=ao(e.keys,e.trans._cache,"clone"===e.cache);return t?Zr.resolve(t):n.getMany(e).then((t=>(e.trans._cache={keys:e.keys,values:"clone"===e.cache?Gn(t):t},t)))},mutate:e=>("add"!==e.type&&(e.trans._cache=null),n.mutate(e))}}})};function co(e){return!("from"in e)}const uo=function(e,t){if(!this){const t=new uo;return e&&"d"in e&&Nn(t,e),t}Nn(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function ho(e,t,n){const r=cs(t,n);if(isNaN(r))return;if(r>0)throw RangeError();if(co(e))return Nn(e,{from:t,to:n,d:1});const i=e.l,s=e.r;if(cs(n,e.from)<0)return i?ho(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},mo(e);if(cs(t,e.to)>0)return s?ho(s,t,n):e.r={from:t,to:n,d:1,l:null,r:null},mo(e);cs(t,e.from)<0&&(e.from=t,e.l=null,e.d=s?s.d+1:1),cs(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);const o=!e.r;i&&!e.l&&fo(e,i),s&&o&&fo(e,s)}function fo(e,t){co(t)||function e(t,{from:n,to:r,l:i,r:s}){ho(t,n,r),i&&e(t,i),s&&e(t,s)}(e,t)}function po(e){let t=co(e)?null:{s:0,n:e};return{next(e){const n=arguments.length>0;for(;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&cs(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||cs(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mo(e){var t,n;const r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){const t="r"===i?"l":"r",n={...e},r=e[i];e.from=r.from,e.to=r.to,e[i]=r[i],n[i]=r[t],e[t]=n,n.d=go(n)}e.d=go(e)}function go({r:e,l:t}){return(e?t?Math.max(e.d,t.d):e.d:t?t.d:0)+1}Sn(uo.prototype,{add(e){return fo(this,e),this},addKey(e){return ho(this,e,e),this},addKeys(e){return e.forEach((e=>ho(this,e,e))),this},[er](){return po(this)}});const yo={stack:"dbcore",level:0,create:e=>{const t=e.schema.name,n=new uo(e.MIN_KEY,e.MAX_KEY);return{...e,table:r=>{const i=e.table(r),{schema:s}=i,{primaryKey:o}=s,{extractKey:a,outbound:l}=o,c={...i,mutate:e=>{const o=e.trans,a=o.mutatedParts||(o.mutatedParts={}),l=e=>{const n=`idb://${t}/${r}/${e}`;return a[n]||(a[n]=new uo)},c=l(""),u=l(":dels"),{type:h}=e;let[d,f]="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[];const p=e.trans._cache;return i.mutate(e).then((e=>{if($n(d)){"delete"!==h&&(d=e.results),c.addKeys(d);const t=ao(d,p);t||"add"===h||u.addKeys(d),(t||f)&&function(e,t,n,r){function i(t){const i=e(t.name||"");function s(e){return null!=e?t.extractKey(e):null}const o=e=>t.multiEntry&&$n(e)?e.forEach((e=>i.addKey(e))):i.addKey(e);(n||r).forEach(((e,t)=>{const i=n&&s(n[t]),a=r&&s(r[t]);0!==cs(i,a)&&(null!=i&&o(i),null!=a&&o(a))}))}t.indexes.forEach(i)}(l,s,t,f)}else if(d){const e={from:d.lower,to:d.upper};u.add(e),c.add(e)}else c.add(n),u.add(n),s.indexes.forEach((e=>l(e.name).add(n)));return e}))}},u=({query:{index:t,range:n}})=>{var r,i;return[t,new uo(null!==(r=n.lower)&&void 0!==r?r:e.MIN_KEY,null!==(i=n.upper)&&void 0!==i?i:e.MAX_KEY)]},h={get:e=>[o,new uo(e.key)],getMany:e=>[o,(new uo).addKeys(e.keys)],count:u,query:u,openCursor:u};return En(h).forEach((e=>{c[e]=function(s){const{subscr:o}=Hr;if(o){const c=e=>{const n=`idb://${t}/${r}/${e}`;return o[n]||(o[n]=new uo)},u=c(""),d=c(":dels"),[f,p]=h[e](s);if(c(f.name||"").add(p),!f.isPrimaryKey){if("count"!==e){const t="query"===e&&l&&s.values&&i.query({...s,values:!1});return i[e].apply(this,arguments).then((n=>{if("query"===e){if(l&&s.values)return t.then((({result:e})=>(u.addKeys(e),n)));const e=s.values?n.result.map(a):n.result;s.values?u.addKeys(e):d.addKeys(e)}else if("openCursor"===e){const e=n,t=s.values;return e&&Object.create(e,{key:{get:()=>(d.addKey(e.primaryKey),e.key)},primaryKey:{get(){const t=e.primaryKey;return d.addKey(t),t}},value:{get:()=>(t&&u.addKey(e.primaryKey),e.value)}})}return n}))}d.add(n)}}return i[e].apply(this,arguments)}})),c}}}};class bo{constructor(e,t){this._middlewares={},this.verno=0;const n=bo.dependencies;this._options=t={addons:bo.addons,autoOpen:!0,indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange,...t},this._deps={indexedDB:t.indexedDB,IDBKeyRange:t.IDBKeyRange};const{addons:r}=t;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;const i={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:kr,dbReadyPromise:null,cancelOpen:kr,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};i.dbReadyPromise=new Zr((e=>{i.dbReadyResolve=e})),i.openCanceller=new Zr(((e,t)=>{i.cancelOpen=t})),this._state=i,this.name=e,this.on=es(this,"populate","blocked","versionchange","close",{ready:[Cr,kr]}),this.on.ready.subscribe=Kn(this.on.ready.subscribe,(e=>(t,n)=>{bo.vip((()=>{const r=this._state;if(r.openComplete)r.dbOpenError||Zr.resolve().then(t),n&&e(t);else if(r.onReadyBeingFired)r.onReadyBeingFired.push(t),n&&e(t);else{e(t);const r=this;n||e((function e(){r.on.ready.unsubscribe(t),r.on.ready.unsubscribe(e)}))}}))})),this.Collection=function(e){return ts(ds.prototype,(function(t,n){this.db=e;let r=Qi,i=null;if(n)try{r=n()}catch(e){i=e}const s=t._ctx,o=s.table,a=o.hook.reading.fire;this._ctx={table:o,index:s.index,isPrimKey:!s.index||o.schema.primKey.keyPath&&s.index===o.schema.primKey.name,range:r,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:i,or:s.or,valueMapper:a!==Er?a:null}}))}(this),this.Table=function(e){return ts(Zi.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:es(null,{creating:[Ar,kr],reading:[$r,Er],updating:[Pr,kr],deleting:[Or,kr]})}))}(this),this.Transaction=function(e){return ts(Os.prototype,(function(t,n,r,i,s){this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=es(this,"complete","error","abort"),this.parent=s||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Zr(((e,t)=>{this._resolve=e,this._reject=t})),this._completion.then((()=>{this.active=!1,this.on.complete.fire()}),(e=>{var t=this.active;return this.active=!1,this.on.error.fire(e),this.parent?this.parent._reject(e):t&&this.idbtrans&&this.idbtrans.abort(),Fi(e)}))}))}(this),this.Version=function(e){return ts(Ys.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return ts(_s.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};const i=e._deps.indexedDB;if(!i)throw new wr.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=(e,t)=>i.cmp(t,e),this._max=(e,t)=>i.cmp(e,t)>0?e:t,this._min=(e,t)=>i.cmp(e,t)<0?e:t,this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(e=>{e.newVersion>0?console.warn(`Another connection wants to upgrade database '${this.name}'. Closing db now to resume the upgrade.`):console.warn(`Another connection wants to delete database '${this.name}'. Closing db now to resume the delete request.`),this.close()})),this.on("blocked",(e=>{!e.newVersion||e.newVersion<e.oldVersion?console.warn(`Dexie.delete('${this.name}') was blocked`):console.warn(`Upgrade '${this.name}' blocked by other connection holding version ${e.oldVersion/10}`)})),this._maxKey=Ts(t.IDBKeyRange),this._createTransaction=(e,t,n,r)=>new this.Transaction(e,t,n,this._options.chromeTransactionDurability,r),this._fireOnBlocked=e=>{this.on("blocked").fire(e),zi.filter((e=>e.name===this.name&&e!==this&&!e._state.vcFired)).map((t=>t.on("versionchange").fire(e)))},this.use(io),this.use(oo),this.use(yo),this.use(lo),this.vip=Object.create(this,{_vip:{value:!0}}),r.forEach((e=>e(this)))}version(e){if(isNaN(e)||e<.1)throw new wr.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new wr.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);const t=this._versions;var n=t.filter((t=>t._cfg.version===e))[0];return n||(n=new this.Version(e),t.push(n),t.sort(Ls),n.stores({}),this._state.autoSchema=!1,n)}_whenReady(e){return this.idbdb&&(this._state.openComplete||Hr.letThrough||this._vip)?e():new Zr(((e,t)=>{if(this._state.openComplete)return t(new wr.DatabaseClosed(this._state.dbOpenError));if(!this._state.isBeingOpened){if(!this._options.autoOpen)return void t(new wr.DatabaseClosed);this.open().catch(kr)}this._state.dbReadyPromise.then(e,t)})).then(e)}use({stack:e,create:t,level:n,name:r}){r&&this.unuse({stack:e,name:r});const i=this._middlewares[e]||(this._middlewares[e]=[]);return i.push({stack:e,create:t,level:null==n?10:n,name:r}),i.sort(((e,t)=>e.level-t.level)),this}unuse({stack:e,name:t,create:n}){return e&&this._middlewares[e]&&(this._middlewares[e]=this._middlewares[e].filter((e=>n?e.create!==n:!!t&&e.name!==t))),this}open(){return Zs(this)}_close(){const e=this._state,t=zi.indexOf(this);if(t>=0&&zi.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new Zr((t=>{e.dbReadyResolve=t})),e.openCanceller=new Zr(((t,n)=>{e.cancelOpen=n}))}close(){this._close();const e=this._state;this._options.autoOpen=!1,e.dbOpenError=new wr.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)}delete(){const e=arguments.length>0,t=this._state;return new Zr(((n,r)=>{const i=()=>{this.close();var e=this._deps.indexedDB.deleteDatabase(this.name);e.onsuccess=pi((()=>{!function({indexedDB:e,IDBKeyRange:t},n){!Gs(e)&&n!==Xi&&Hs(e,t).delete(n).catch(kr)}(this._deps,this.name),n()})),e.onerror=ks(r),e.onblocked=this._fireOnBlocked};if(e)throw new wr.InvalidArgument("Arguments not allowed in db.delete()");t.isBeingOpened?t.dbReadyPromise.then(i):i()}))}backendDB(){return this.idbdb}isOpen(){return null!==this.idbdb}hasBeenClosed(){const e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name}hasFailed(){return null!==this._state.dbOpenError}dynamicallyOpened(){return this._state.autoSchema}get tables(){return En(this._allTables).map((e=>this._allTables[e]))}transaction(){const e=to.apply(this,arguments);return this._transaction.apply(this,e)}_transaction(e,t,n){let r=Hr.trans;r&&r.db===this&&-1===e.indexOf("!")||(r=null);const i=-1!==e.indexOf("?");let s,o;e=e.replace("!","").replace("?","");try{if(o=t.map((e=>{var t=e instanceof this.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||e===Yi)s=Yi;else{if("rw"!=e&&e!=Hi)throw new wr.InvalidArgument("Invalid transaction mode: "+e);s=Hi}if(r){if(r.mode===Yi&&s===Hi){if(!i)throw new wr.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");r=null}r&&o.forEach((e=>{if(r&&-1===r.storeNames.indexOf(e)){if(!i)throw new wr.SubTransaction("Table "+e+" not included in parent transaction.");r=null}})),i&&r&&!r.active&&(r=null)}}catch(e){return r?r._promise(null,((t,n)=>{n(e)})):Fi(e)}const a=no.bind(null,this,s,o,r,n);return r?r._promise(s,a,"lock"):Hr.trans?Pi(Hr.transless,(()=>this._whenReady(a))):this._whenReady(a)}table(e){if(!Pn(this._allTables,e))throw new wr.InvalidTable(`Table ${e} does not exist`);return this._allTables[e]}}const vo="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable";class wo{constructor(e){this._subscribe=e}subscribe(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})}[vo](){return this}}function xo(e,t){return En(t).forEach((n=>{fo(e[n]||(e[n]=new uo),t[n])})),e}function _o(e){return new wo((t=>{const n=ir(e);let r=!1,i={},s={};const o={get closed(){return r},unsubscribe:()=>{r=!0,As.storagemutated.unsubscribe(u)}};t.start&&t.start(o);let a=!1,l=!1;function c(){return En(s).some((e=>i[e]&&function(e,t){const n=po(t);let r=n.next();if(r.done)return!1;let i=r.value;const s=po(e);let o=s.next(i.from),a=o.value;for(;!r.done&&!o.done;){if(cs(a.from,i.to)<=0&&cs(a.to,i.from)>=0)return!0;cs(i.from,a.from)<0?i=(r=n.next(a.from)).value:a=(o=s.next(i.from)).value}return!1}(i[e],s[e])))}const u=e=>{xo(i,e),c()&&h()},h=()=>{if(a||r)return;i={};const d={},f=function(t){n&&_i();const r=()=>xi(e,{subscr:t,trans:null}),i=Hr.trans?Pi(Hr.transless,r):r();return n&&i.then(ki,ki),i}(d);l||(As($s,u),l=!0),a=!0,Promise.resolve(f).then((e=>{a=!1,r||(c()?h():(i={},s=d,t.next&&t.next(e)))}),(e=>{a=!1,t.error&&t.error(e),o.unsubscribe()}))};return h(),o}))}let ko;try{ko={indexedDB:kn.indexedDB||kn.mozIndexedDB||kn.webkitIndexedDB||kn.msIndexedDB,IDBKeyRange:kn.IDBKeyRange||kn.webkitIDBKeyRange}}catch(e){ko={indexedDB:null,IDBKeyRange:null}}const Eo=bo;function $o(e){let t=No;try{No=!0,As.storagemutated.fire(e)}finally{No=t}}Sn(Eo,{..._r,delete:e=>new Eo(e,{addons:[]}).delete(),exists:e=>new Eo(e,{addons:[]}).open().then((e=>(e.close(),!0))).catch("NoSuchDatabaseError",(()=>!1)),getDatabaseNames(e){try{return function({indexedDB:e,IDBKeyRange:t}){return Gs(e)?Promise.resolve(e.databases()).then((e=>e.map((e=>e.name)).filter((e=>e!==Xi)))):Hs(e,t).toCollection().primaryKeys()}(Eo.dependencies).then(e)}catch(e){return Fi(new wr.MissingAPI)}},defineClass:()=>function(e){Nn(this,e)},ignoreTransaction:e=>Hr.trans?Pi(Hr.transless,e):e(),vip:Qs,async:function(e){return function(){try{var t=eo(e.apply(this,arguments));return t&&"function"==typeof t.then?t:Zr.resolve(t)}catch(e){return Fi(e)}}},spawn:function(e,t,n){try{var r=eo(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:Zr.resolve(r)}catch(e){return Fi(e)}},currentTransaction:{get:()=>Hr.trans||null},waitFor:function(e,t){const n=Zr.resolve("function"==typeof e?Eo.ignoreTransaction(e):e).timeout(t||6e4);return Hr.trans?Hr.trans.waitFor(n):n},Promise:Zr,debug:{get:()=>sr,set:e=>{or(e,"dexie"===e?()=>!0:Wi)}},derive:jn,extend:Nn,props:Sn,override:Kn,Events:es,on:As,liveQuery:_o,extendObservabilitySet:xo,getByKeyPath:zn,setByKeyPath:qn,delByKeyPath:function(e,t){"string"==typeof t?qn(e,t,void 0):"length"in t&&[].map.call(t,(function(t){qn(e,t,void 0)}))},shallowClone:Vn,deepClone:Gn,getObjectDiff:so,cmp:cs,asap:Mn,minKey:Ri,addons:[],connections:zi,errnames:br,dependencies:ko,semVer:Di,version:Di.split(".").map((e=>parseInt(e))).reduce(((e,t,n)=>e+t/Math.pow(10,2*n)))}),Eo.maxKey=Ts(Eo.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(As($s,(e=>{if(!No){let t;qi?(t=document.createEvent("CustomEvent"),t.initCustomEvent(Ns,!0,!0,e)):t=new CustomEvent(Ns,{detail:e}),No=!0,dispatchEvent(t),No=!1}})),addEventListener(Ns,(({detail:e})=>{No||$o(e)})));let No=!1;if("undefined"!=typeof BroadcastChannel){const e=new BroadcastChannel(Ns);As($s,(t=>{No||e.postMessage(t)})),e.onmessage=e=>{e.data&&$o(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){As($s,(e=>{try{No||("undefined"!=typeof localStorage&&localStorage.setItem(Ns,JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&[...self.clients.matchAll({includeUncontrolled:!0})].forEach((t=>t.postMessage({type:Ns,changedParts:e}))))}catch(e){}})),"undefined"!=typeof addEventListener&&addEventListener("storage",(e=>{if(e.key===Ns){const t=JSON.parse(e.newValue);t&&$o(t.changedParts)}}));const e=self.document&&navigator.serviceWorker;e&&e.addEventListener("message",(function({data:e}){e&&e.type===Ns&&$o(e.changedParts)}))}Zr.rejectionMapper=function(e,t){if(!e||e instanceof pr||e instanceof TypeError||e instanceof SyntaxError||!e.name||!xr[e.name])return e;var n=new xr[e.name](t||e.message,e);return"stack"in e&&Tn(n,"stack",{get:function(){return this.inner.stack}}),n},or(sr,Wi);const Ao=new class extends bo{constructor(){super("bookDB"),this.version(1).stores({books:"++id, author, title, cover, file"})}},Oo=e=>({}),Po=e=>({}),So=e=>({}),Co=e=>({}),To=e=>({}),jo=e=>({});function Bo(e){let t,n,r,i,s,o,a;const l=e[1].leftbar,c=u(l,e,e[0],jo),h=e[1].toptext,v=u(h,e,e[0],Co),x=e[1].rightbar,_=u(x,e,e[0],Po);return{c(){t=b("div"),n=b("div"),c&&c.c(),r=w(),i=b("div"),v&&v.c(),s=w(),o=b("div"),_&&_.c(),k(n,"class","buttonbar svelte-19z76ni"),k(n,"id","leftbar"),k(i,"id","toptext"),k(i,"class","svelte-19z76ni"),k(o,"class","buttonbar svelte-19z76ni"),k(o,"id","rightbar"),k(t,"id","topbar"),k(t,"class","svelte-19z76ni")},m(e,l){g(e,t,l),m(t,n),c&&c.m(n,null),m(t,r),m(t,i),v&&v.m(i,null),m(t,s),m(t,o),_&&_.m(o,null),a=!0},p(e,[t]){c&&c.p&&(!a||1&t)&&f(c,l,e,e[0],a?d(l,e[0],t,To):p(e[0]),jo),v&&v.p&&(!a||1&t)&&f(v,h,e,e[0],a?d(h,e[0],t,So):p(e[0]),Co),_&&_.p&&(!a||1&t)&&f(_,x,e,e[0],a?d(x,e[0],t,Oo):p(e[0]),Po)},i(e){a||(X(c,e),X(v,e),X(_,e),a=!0)},o(e){Y(c,e),Y(v,e),Y(_,e),a=!1},d(e){e&&y(t),c&&c.d(e),v&&v.d(e),_&&_.d(e)}}}function Fo(e,t,n){let{$$slots:r={},$$scope:i}=t;return e.$$set=e=>{"$$scope"in e&&n(0,i=e.$$scope)},[i,r]}class Io extends re{constructor(e){super(),ne(this,e,Fo,Bo,s,{})}}function Do(t){let n,s,o,a,l;const c=t[4].default,h=u(c,t,t[3],null);return{c(){n=b("div"),h&&h.c(),k(n,"id","popover"),N(n,"top",t[1]),N(n,"right",t[2]),k(n,"class","svelte-5z79nf")},m(r,c){var u;g(r,n,c),h&&h.m(n,null),o=!0,a||(l=[(u=s=Ro.call(null,n),u&&i(u.destroy)?u.destroy:e),_(n,"outclick",t[5])],a=!0)},p(e,t){h&&h.p&&(!o||8&t)&&f(h,c,e,e[3],o?d(c,e[3],t,null):p(e[3]),null),(!o||2&t)&&N(n,"top",e[1]),(!o||4&t)&&N(n,"right",e[2])},i(e){o||(X(h,e),o=!0)},o(e){Y(h,e),o=!1},d(e){e&&y(n),h&&h.d(e),a=!1,r(l)}}}function Ko(e){let t,n,r=e[0]&&Do(e);return{c(){r&&r.c(),t=x()},m(e,i){r&&r.m(e,i),g(e,t,i),n=!0},p(e,[n]){e[0]?r?(r.p(e,n),1&n&&X(r,1)):(r=Do(e),r.c(),X(r,1),r.m(t.parentNode,t)):r&&(U(),Y(r,1,1,(()=>{r=null})),W())},i(e){n||(X(r),n=!0)},o(e){Y(r),n=!1},d(e){r&&r.d(e),e&&y(t)}}}function Ro(e){const t=t=>{t.target instanceof Element&&(e.contains(t.target)||"settingsBtn"===t.target.className||e.dispatchEvent(new CustomEvent("outclick")))};return document.addEventListener("click",t,!0),{destroy(){document.removeEventListener("click",t,!0)}}}function Mo(e,t,n){let{$$slots:r={},$$scope:i}=t,{visible:s}=t,{top:o}=t,{right:a}=t;return e.$$set=e=>{"visible"in e&&n(0,s=e.visible),"top"in e&&n(1,o=e.top),"right"in e&&n(2,a=e.right),"$$scope"in e&&n(3,i=e.$$scope)},[s,o,a,i,r,()=>n(0,s=!1)]}class Lo extends re{constructor(e){super(),ne(this,e,Mo,Ko,s,{visible:0,top:1,right:2})}}function zo(t){let n,i,s,o,a,l,c,u,h;return{c(){n=b("div"),n.textContent="warm",i=w(),s=b("div"),s.textContent="black",o=w(),a=b("div"),a.textContent="dark",l=w(),c=b("div"),c.textContent="light",N(n,"background-color","#f6e4bd"),N(n,"color","#000"),k(n,"class","svelte-7vb56k"),N(s,"background-color","#000"),N(s,"color","#e9e9e9"),k(s,"class","svelte-7vb56k"),N(a,"background-color","#032038"),N(a,"color","#e9e9e9"),k(a,"class","svelte-7vb56k"),N(c,"background-color","#fff"),N(c,"color","#000"),k(c,"class","svelte-7vb56k")},m(e,r){g(e,n,r),g(e,i,r),g(e,s,r),g(e,o,r),g(e,a,r),g(e,l,r),g(e,c,r),u||(h=[_(n,"click",t[1]),_(s,"click",t[2]),_(a,"click",t[3]),_(c,"click",t[4])],u=!0)},p:e,i:e,o:e,d(e){e&&y(n),e&&y(i),e&&y(s),e&&y(o),e&&y(a),e&&y(l),e&&y(c),u=!1,r(h)}}}function qo(e,t,n){let{theme:r}=t;return e.$$set=e=>{"theme"in e&&n(0,r=e.theme)},[r,()=>n(0,r="warm"),()=>n(0,r="black"),()=>n(0,r="dark"),()=>n(0,r="light")]}class Vo extends re{constructor(e){super(),ne(this,e,qo,zo,s,{theme:0})}}function Uo(e){let t,n,i,s,o,a,l,c,u,h,d,f,p,v,x,E,O,P,S,C,j,B,F,I;function R(t){e[5](t)}let M={};return void 0!==e[0]&&(M.theme=e[0]),C=new Vo({props:M}),T.push((()=>Q(C,"theme",R))),{c(){t=b("label"),t.textContent="Font:",n=w(),i=b("br"),s=w(),o=b("select"),a=b("option"),a.textContent="Verdana",l=b("option"),l.textContent="Arial",c=b("option"),c.textContent="Courier New ",u=b("option"),u.textContent="Helvetica",h=b("option"),h.textContent="Times New Roman",d=w(),f=b("br"),p=w(),v=b("label"),v.textContent="Font size:",x=w(),E=b("br"),O=w(),P=b("input"),S=w(),J(C.$$.fragment),k(t,"for","fontpicker"),N(a,"font-family","'Verdana'"),a.__value="Verdana",a.value=a.__value,N(l,"font-family","'Arial'"),l.__value="Arial",l.value=l.__value,N(c,"font-family","'Courier New '"),c.__value="Courier New ",c.value=c.__value,N(u,"font-family","'Helvetica'"),u.__value="Helvetica",u.value=u.__value,N(h,"font-family","'Times New Roman'"),h.__value="Times New Roman",h.value=h.__value,k(o,"name","fontpicker"),N(o,"width","100%"),void 0===e[1].fontFamily&&D((()=>e[3].call(o))),k(v,"for","fontsize"),k(P,"name","fontsize"),k(P,"type","range"),k(P,"min","12"),k(P,"max","40")},m(r,y){g(r,t,y),g(r,n,y),g(r,i,y),g(r,s,y),g(r,o,y),m(o,a),m(o,l),m(o,c),m(o,u),m(o,h),A(o,e[1].fontFamily),g(r,d,y),g(r,f,y),g(r,p,y),g(r,v,y),g(r,x,y),g(r,E,y),g(r,O,y),g(r,P,y),$(P,e[1].fontSize),g(r,S,y),Z(C,r,y),B=!0,F||(I=[_(o,"change",e[3]),_(P,"change",e[4]),_(P,"input",e[4])],F=!0)},p(e,t){2&t&&A(o,e[1].fontFamily),2&t&&$(P,e[1].fontSize);const n={};!j&&1&t&&(j=!0,n.theme=e[0],K((()=>j=!1))),C.$set(n)},i(e){B||(X(C.$$.fragment,e),B=!0)},o(e){Y(C.$$.fragment,e),B=!1},d(e){e&&y(t),e&&y(n),e&&y(i),e&&y(s),e&&y(o),e&&y(d),e&&y(f),e&&y(p),e&&y(v),e&&y(x),e&&y(E),e&&y(O),e&&y(P),e&&y(S),ee(C,e),F=!1,r(I)}}}function Wo(e){let t,n,r;function i(t){e[6](t)}let s={top:"3.1em",right:"1%",$$slots:{default:[Uo]},$$scope:{ctx:e}};return void 0!==e[2]&&(s.visible=e[2]),t=new Lo({props:s}),T.push((()=>Q(t,"visible",i))),{c(){J(t.$$.fragment)},m(e,n){Z(t,e,n),r=!0},p(e,[r]){const i={};131&r&&(i.$$scope={dirty:r,ctx:e}),!n&&4&r&&(n=!0,i.visible=e[2],K((()=>n=!1))),t.$set(i)},i(e){r||(X(t.$$.fragment,e),r=!0)},o(e){Y(t.$$.fragment,e),r=!1},d(e){ee(t,e)}}}function Xo(e,t,n){let{theme:r}=t,{settings:i={fontSize:16,fontFamily:"Verdana"}}=t,{settingsVisible:s=!1}=t;return e.$$set=e=>{"theme"in e&&n(0,r=e.theme),"settings"in e&&n(1,i=e.settings),"settingsVisible"in e&&n(2,s=e.settingsVisible)},[r,i,s,function(){i.fontFamily=function(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}(this),n(1,i)},function(){var e;i.fontSize=""===(e=this.value)?null:+e,n(1,i)},function(e){r=e,n(0,r)},function(e){s=e,n(2,s)}]}class Yo extends re{constructor(e){super(),ne(this,e,Xo,Wo,s,{theme:0,settings:1,settingsVisible:2})}}const{document:Ho}=H;function Go(t){let n,r,i;return{c(){n=b("button"),n.textContent="<",k(n,"slot","leftbar"),N(n,"opacity","0.5")},m(e,s){g(e,n,s),r||(i=_(n,"click",t[13]),r=!0)},p:e,d(e){e&&y(n),r=!1,i()}}}function Qo(e){let t,n,r,i,s,o,a,l,c,u,h,d,f=void 0!==e[2]?e[2].meta.title+" - ":"",p=(void 0!==e[2]?e[2].meta.author:"")+"",x=e[2].contents.length+"";return{c(){t=b("div"),n=b("h4"),r=b("b"),i=v(f),s=w(),o=v(p),a=w(),l=b("p"),c=v(e[3]),u=v("/"),h=v(x),k(n,"class","svelte-ketruh"),k(l,"id","progress"),k(l,"class","svelte-ketruh"),k(t,"slot","toptext"),k(t,"style",d="transition: opacity 0.3s; "+(e[6]>100?"opacity: 0.5;":""))},m(e,d){g(e,t,d),m(t,n),m(n,r),m(r,i),m(n,s),m(n,o),m(t,a),m(t,l),m(l,c),m(l,u),m(l,h)},p(e,n){4&n&&f!==(f=void 0!==e[2]?e[2].meta.title+" - ":"")&&E(i,f),4&n&&p!==(p=(void 0!==e[2]?e[2].meta.author:"")+"")&&E(o,p),8&n&&E(c,e[3]),4&n&&x!==(x=e[2].contents.length+"")&&E(h,x),64&n&&d!==(d="transition: opacity 0.3s; "+(e[6]>100?"opacity: 0.5;":""))&&k(t,"style",d)},d(e){e&&y(t)}}}function Jo(t){let n,i,s,o,a,l,c,u;return{c(){n=b("div"),i=b("button"),i.textContent="⚙",s=w(),o=b("button"),o.textContent="«",a=w(),l=b("button"),l.textContent="»",k(i,"class","settingsBtn"),k(n,"slot","rightbar"),N(n,"display","inline-block")},m(e,r){g(e,n,r),m(n,i),m(n,s),m(n,o),m(n,a),m(n,l),c||(u=[_(i,"click",t[10]),_(o,"click",t[11]),_(l,"click",t[12])],c=!0)},p:e,d(e){e&&y(n),c=!1,r(u)}}}function Zo(e){let t,n,i,s,o,a,l,c,u,h,d,f,p,v,x,E,$,A=!1,P=()=>{A=!1},S=e[2].contents[e[3]]+"",C=e[2].contents[e[3]+1]+"";function j(t){e[14](t)}function B(t){e[15](t)}function F(t){e[16](t)}D(e[9]),Ho.title=n="\n        "+e[2].meta.title+" - "+e[2].meta.author+"\n    ",s=new Io({props:{$$slots:{rightbar:[Jo],toptext:[Qo],leftbar:[Go]},$$scope:{ctx:e}}});let I={};return void 0!==e[0]&&(I.theme=e[0]),void 0!==e[4]&&(I.settingsVisible=e[4]),void 0!==e[5]&&(I.settings=e[5]),d=new Yo({props:I}),T.push((()=>Q(d,"theme",j))),T.push((()=>Q(d,"settingsVisible",B))),T.push((()=>Q(d,"settings",F))),{c(){i=w(),J(s.$$.fragment),o=w(),a=b("div"),l=new O(!1),c=w(),u=new O(!1),h=w(),J(d.$$.fragment),l.a=c,u.a=null,k(a,"id","container"),N(a,"font-size",e[5].fontSize+"px"),N(a,"font-family",e[5].fontFamily),k(a,"class","svelte-ketruh")},m(n,r){g(n,i,r),Z(s,n,r),g(n,o,r),g(n,a,r),l.m(S,a),m(a,c),u.m(C,a),g(n,h,r),Z(d,n,r),x=!0,E||($=[_(window,"keydown",e[8]),_(window,"scroll",(()=>{A=!0,clearTimeout(t),t=setTimeout(P,100),e[9]()}))],E=!0)},p(e,[r]){64&r&&!A&&(A=!0,clearTimeout(t),scrollTo(window.pageXOffset,e[6]),t=setTimeout(P,100)),(!x||4&r)&&n!==(n="\n        "+e[2].meta.title+" - "+e[2].meta.author+"\n    ")&&(Ho.title=n);const i={};524382&r&&(i.$$scope={dirty:r,ctx:e}),s.$set(i),(!x||12&r)&&S!==(S=e[2].contents[e[3]]+"")&&l.p(S),(!x||12&r)&&C!==(C=e[2].contents[e[3]+1]+"")&&u.p(C),(!x||32&r)&&N(a,"font-size",e[5].fontSize+"px"),(!x||32&r)&&N(a,"font-family",e[5].fontFamily);const o={};!f&&1&r&&(f=!0,o.theme=e[0],K((()=>f=!1))),!p&&16&r&&(p=!0,o.settingsVisible=e[4],K((()=>p=!1))),!v&&32&r&&(v=!0,o.settings=e[5],K((()=>v=!1))),d.$set(o)},i(e){x||(X(s.$$.fragment,e),X(d.$$.fragment,e),x=!0)},o(e){Y(s.$$.fragment,e),Y(d.$$.fragment,e),x=!1},d(e){e&&y(i),ee(s,e),e&&y(o),e&&y(a),e&&y(h),ee(d,e),E=!1,r($)}}}function ea(e,t,n){let{book:r}=t,{theme:i}=t,{reading:s}=t,o=0,a=!1,l={fontSize:16,fontFamily:"Verdana"},c=0,u=r.meta.title;S((()=>{u!=r.meta.title&&(n(3,o=0),u=r.meta.title,h())}));const h=()=>{for(let e of document.getElementsByTagName("style"))e.innerHTML="";r.styles.forEach((e=>{const t=document.createElement("style");t.innerText=e.css,document.head.appendChild(t)}))},d=e=>{0<=o+e&&o+e<=r.contents.length&&(n(3,o+=e),n(6,c=0))};h();return e.$$set=e=>{"book"in e&&n(2,r=e.book),"theme"in e&&n(0,i=e.theme),"reading"in e&&n(1,s=e.reading)},[i,s,r,o,a,l,c,d,({key:e})=>{switch(e){case"ArrowLeft":d(-2);break;case"ArrowRight":d(2)}},function(){n(6,c=window.pageYOffset)},()=>n(4,a=!a),()=>d(-2),()=>d(2),()=>{n(1,s=!1),document.title="Essence Reader"},function(e){i=e,n(0,i)},function(e){a=e,n(4,a)},function(e){l=e,n(5,l)}]}class ta extends re{constructor(e){super(),ne(this,e,ea,Zo,s,{book:2,theme:0,reading:1})}}function na(e,t,n){const r=e.slice();return r[8]=t[n],r}function ra(e){let t,n,r,i=[],s=new Map,o=e[1];const a=e=>e[8].id;for(let t=0;t<o.length;t+=1){let n=na(e,o,t),r=a(n);s.set(r,i[t]=ia(r,n))}const l=e[5].default,c=u(l,e,e[4],null);return{c(){t=b("div");for(let e=0;e<i.length;e+=1)i[e].c();n=w(),c&&c.c(),k(t,"id","parent"),k(t,"class","svelte-1wotm9k")},m(e,s){g(e,t,s);for(let e=0;e<i.length;e+=1)i[e].m(t,null);m(t,n),c&&c.m(t,null),r=!0},p(e,u){11&u&&(o=e[1],i=function(e,t,n,r,i,s,o,a,l,c,u,h){let d=e.length,f=s.length,p=d;const m={};for(;p--;)m[e[p].key]=p;const g=[],y=new Map,b=new Map;for(p=f;p--;){const e=h(i,s,p),a=n(e);let l=o.get(a);l?r&&l.p(e,t):(l=c(a,e),l.c()),y.set(a,g[p]=l),a in m&&b.set(a,Math.abs(p-m[a]))}const v=new Set,w=new Set;function x(e){X(e,1),e.m(a,u),o.set(e.key,e),u=e.first,f--}for(;d&&f;){const t=g[f-1],n=e[d-1],r=t.key,i=n.key;t===n?(u=t.first,d--,f--):y.has(i)?!o.has(r)||v.has(r)?x(t):w.has(i)?d--:b.get(r)>b.get(i)?(w.add(r),x(t)):(v.add(i),d--):(l(n,o),d--)}for(;d--;){const t=e[d];y.has(t.key)||l(t,o)}for(;f;)x(g[f-1]);return g}(i,u,a,1,e,o,s,t,G,ia,n,na)),c&&c.p&&(!r||16&u)&&f(c,l,e,e[4],r?d(l,e[4],u,null):p(e[4]),null)},i(e){r||(X(c,e),r=!0)},o(e){Y(c,e),r=!1},d(e){e&&y(t);for(let e=0;e<i.length;e+=1)i[e].d();c&&c.d(e)}}}function ia(e,t){let n,i,s,o,a,c,u,h,d,f,p=t[8].author+" - "+t[8].title;function x(...e){return t[6](t[8],...e)}function $(){return t[7](t[8])}return{key:e,first:null,c(){n=b("div"),i=b("button"),i.textContent="Delete book",s=w(),o=b("img"),c=w(),u=b("p"),h=v(p),k(i,"id","deleteBtn"),k(i,"class","svelte-1wotm9k"),l(o.src,a=void 0!==t[8].cover?URL.createObjectURL(t[8].cover):"")||k(o,"src",a),k(o,"alt","cover"),k(o,"class","svelte-1wotm9k"),k(n,"id","book"),k(n,"class","svelte-1wotm9k"),this.first=n},m(e,t){g(e,n,t),m(n,i),m(n,s),m(n,o),m(n,c),m(n,u),m(u,h),d||(f=[_(i,"click",x),_(n,"click",$)],d=!0)},p(e,n){t=e,2&n&&!l(o.src,a=void 0!==t[8].cover?URL.createObjectURL(t[8].cover):"")&&k(o,"src",a),2&n&&p!==(p=t[8].author+" - "+t[8].title)&&E(h,p)},d(e){e&&y(n),d=!1,r(f)}}}function sa(e){let t,n,r=e[1]&&ra(e);return{c(){r&&r.c(),t=x()},m(e,i){r&&r.m(e,i),g(e,t,i),n=!0},p(e,[n]){e[1]?r?(r.p(e,n),2&n&&X(r,1)):(r=ra(e),r.c(),X(r,1),r.m(t.parentNode,t)):r&&(U(),Y(r,1,1,(()=>{r=null})),W())},i(e){n||(X(r),n=!0)},o(e){Y(r),n=!1},d(e){r&&r.d(e),e&&y(t)}}}function oa(e,t,n){let r,{$$slots:i={},$$scope:s}=t,{readFiles:o=(e=>{})}=t,a=_o((()=>Ao.books.toArray()));async function l(e){await Ao.books.delete(e)}c(e,a,(e=>n(1,r=e)));return e.$$set=e=>{"readFiles"in e&&n(0,o=e.readFiles),"$$scope"in e&&n(4,s=e.$$scope)},[o,r,a,l,s,i,(e,t)=>{t.stopPropagation(),l(e.id)},e=>o(e.file)]}class aa extends re{constructor(e){super(),ne(this,e,oa,sa,s,{readFiles:0})}}function la(e){let t,n,r,i,s,o,a;function l(t){e[13](t)}t=new Io({props:{$$slots:{rightbar:[ha],toptext:[ua]},$$scope:{ctx:e}}});let c={top:"3.1em",right:"1%",$$slots:{default:[da]},$$scope:{ctx:e}};return void 0!==e[5]&&(c.visible=e[5]),r=new Lo({props:c}),T.push((()=>Q(r,"visible",l))),o=new aa({props:{readFiles:e[6],$$slots:{default:[fa]},$$scope:{ctx:e}}}),{c(){J(t.$$.fragment),n=w(),J(r.$$.fragment),s=w(),J(o.$$.fragment)},m(e,i){Z(t,e,i),g(e,n,i),Z(r,e,i),g(e,s,i),Z(o,e,i),a=!0},p(e,n){const s={};262176&n&&(s.$$scope={dirty:n,ctx:e}),t.$set(s);const a={};262147&n&&(a.$$scope={dirty:n,ctx:e}),!i&&32&n&&(i=!0,a.visible=e[5],K((()=>i=!1))),r.$set(a);const l={};262160&n&&(l.$$scope={dirty:n,ctx:e}),o.$set(l)},i(e){a||(X(t.$$.fragment,e),X(r.$$.fragment,e),X(o.$$.fragment,e),a=!0)},o(e){Y(t.$$.fragment,e),Y(r.$$.fragment,e),Y(o.$$.fragment,e),a=!1},d(e){ee(t,e),e&&y(n),ee(r,e),e&&y(s),ee(o,e)}}}function ca(e){let t,n,r,i;function s(t){e[8](t)}function o(t){e[9](t)}let a={book:e[2]};return void 0!==e[1]&&(a.theme=e[1]),void 0!==e[3]&&(a.reading=e[3]),t=new ta({props:a}),T.push((()=>Q(t,"theme",s))),T.push((()=>Q(t,"reading",o))),{c(){J(t.$$.fragment)},m(e,n){Z(t,e,n),i=!0},p(e,i){const s={};4&i&&(s.book=e[2]),!n&&2&i&&(n=!0,s.theme=e[1],K((()=>n=!1))),!r&&8&i&&(r=!0,s.reading=e[3],K((()=>r=!1))),t.$set(s)},i(e){i||(X(t.$$.fragment,e),i=!0)},o(e){Y(t.$$.fragment,e),i=!1},d(e){ee(t,e)}}}function ua(t){let n;return{c(){n=b("h3"),n.textContent="Essence Reader",k(n,"slot","toptext"),N(n,"display","inline")},m(e,t){g(e,n,t)},p:e,d(e){e&&y(n)}}}function ha(t){let n,r,i;return{c(){n=b("button"),n.textContent="⚙",k(n,"class","settingsBtn"),k(n,"slot","rightbar")},m(e,s){g(e,n,s),r||(i=_(n,"click",t[10]),r=!0)},p:e,d(e){e&&y(n),r=!1,i()}}}function da(e){let t,n,r,i,s,o,a,l,c,u,h,d,f,p,x;function E(t){e[12](t)}let $={};return void 0!==e[1]&&($.theme=e[1]),h=new Vo({props:$}),T.push((()=>Q(h,"theme",E))),{c(){t=b("div"),n=b("label"),r=b("input"),i=v("\n\t\t\t\t\tSave books\n\t\t\t\t"),s=b("br"),o=w(),a=b("hr"),l=w(),c=b("p"),c.textContent="Select theme",u=w(),J(h.$$.fragment),k(r,"type","checkbox"),N(n,"user-select","none"),N(c,"display","inline"),N(t,"width","8em")},m(d,y){g(d,t,y),m(t,n),m(n,r),r.checked=e[0],m(n,i),m(t,s),m(t,o),m(t,a),m(t,l),m(t,c),m(t,u),Z(h,t,null),f=!0,p||(x=_(r,"change",e[11]),p=!0)},p(e,t){1&t&&(r.checked=e[0]);const n={};!d&&2&t&&(d=!0,n.theme=e[1],K((()=>d=!1))),h.$set(n)},i(e){f||(X(h.$$.fragment,e),f=!0)},o(e){Y(h.$$.fragment,e),f=!1},d(e){e&&y(t),ee(h),p=!1,x()}}}function fa(e){let t,n,r,i,s,o,a,l;return{c(){t=b("div"),n=b("h1"),n.textContent="📚",r=w(),i=b("h2"),s=v("Drop anywhere or click to select a file"),k(n,"class","svelte-1mczpww"),N(i,"color",e[4]?"green":"gray"),k(t,"id","dropInfo"),k(t,"style",o=e[4]?"border: 1px solid green; background-color: #dfffdf":""),k(t,"class","svelte-1mczpww")},m(o,c){g(o,t,c),m(t,n),m(t,r),m(t,i),m(i,s),a||(l=_(t,"click",e[14]),a=!0)},p(e,n){16&n&&N(i,"color",e[4]?"green":"gray"),16&n&&o!==(o=e[4]?"border: 1px solid green; background-color: #dfffdf":"")&&k(t,"style",o)},d(e){e&&y(t),a=!1,l()}}}function pa(e){let t,n,r,i;const s=[ca,la],o=[];function a(e,t){return e[3]?0:1}return n=a(e),r=o[n]=s[n](e),{c(){t=b("main"),r.c()},m(e,r){g(e,t,r),o[n].m(t,null),i=!0},p(e,[i]){let l=n;n=a(e),n===l?o[n].p(e,i):(U(),Y(o[l],1,1,(()=>{o[l]=null})),W(),r=o[n],r?r.p(e,i):(r=o[n]=s[n](e),r.c()),X(r,1),r.m(t,null))},i(e){i||(X(r),i=!0)},o(e){Y(r),i=!1},d(e){e&&y(t),o[n].d()}}}function ma(e,t,n){let r;async function i(e){n(2,r=await pn(e));let t=e.size<3e7;for(let e of await Ao.books.toArray())e.title===r.meta.title&&(t=!1);t&&s&&async function(e,t){try{await Ao.books.add({author:e.author,title:e.title,cover:await fetch(e.cover).then((e=>e.blob())),file:t})}catch(e){console.log(e)}}(r.meta,e),n(3,o=!0)}let s,o=!1,a=!1;s=null===localStorage.getItem("saveBooksOn")||JSON.parse(localStorage.getItem("saveBooksOn"));window.addEventListener("dragenter",(e=>{e.dataTransfer.types.includes("Files")&&n(4,a=!0)})),window.addEventListener("dragleave",(e=>{n(4,a=!1),e.preventDefault()})),window.addEventListener("dragover",(e=>e.preventDefault())),window.addEventListener("drop",(e=>{e.preventDefault(),n(4,a=!1),i(e.dataTransfer.files[0])}));const l=()=>{let e=document.createElement("input");e.type="file",e.onchange=e=>{i(e.target.files[0])},e.click()};let c;c=null!==localStorage.getItem("theme")?localStorage.getItem("theme"):window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";let u=!1;return e.$$.update=()=>{1&e.$$.dirty&&localStorage.setItem("saveBooksOn",JSON.stringify(s)),2&e.$$.dirty&&(document.documentElement.setAttribute("data-theme",c),localStorage.setItem("theme",c))},[s,c,r,o,a,u,i,l,function(e){c=e,n(1,c)},function(e){o=e,n(3,o)},()=>n(5,u=!u),function(){s=this.checked,n(0,s)},function(e){c=e,n(1,c)},function(e){u=e,n(5,u)},()=>l()]}return new class extends re{constructor(e){super(),ne(this,e,ma,pa,s,{})}}({target:document.body})}();
